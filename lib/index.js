!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(global,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=24)}([function(e,t,r){"use strict";var n=r(2),o="undefined"==typeof navigator,i={e:{}},s,a="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:void 0!==this?this:null;function u(){try{var e=s;return s=null,e.apply(this,arguments)}catch(e){return i.e=e,i}}function c(e){return s=e,u}var l=function(e,t){var r={}.hasOwnProperty;function n(){for(var n in this.constructor=e,this.constructor$=t,t.prototype)r.call(t.prototype,n)&&"$"!==n.charAt(n.length-1)&&(this[n+"$"]=t.prototype[n])}return n.prototype=t.prototype,e.prototype=new n,e.prototype};function h(e){return null==e||!0===e||!1===e||"string"==typeof e||"number"==typeof e}function p(e){return"function"==typeof e||"object"==typeof e&&null!==e}function f(e){return h(e)?new Error(j(e)):e}function d(e,t){var r,n=e.length,o=new Array(n+1);for(r=0;r<n;++r)o[r]=e[r];return o[r]=t,o}function _(e,t,r){if(!n.isES5)return{}.hasOwnProperty.call(e,t)?e[t]:void 0;var o=Object.getOwnPropertyDescriptor(e,t);return null!=o?null==o.get&&null==o.set?o.value:r:void 0}function v(e,t,r){if(h(e))return e;var o={value:r,configurable:!0,enumerable:!1,writable:!0};return n.defineProperty(e,t,o),e}function y(e){throw e}var m=function(){var e=[Array.prototype,Object.prototype,Function.prototype],t=function(t){for(var r=0;r<e.length;++r)if(e[r]===t)return!0;return!1};if(n.isES5){var r=Object.getOwnPropertyNames;return function(e){for(var o=[],i=Object.create(null);null!=e&&!t(e);){var s;try{s=r(e)}catch(e){return o}for(var a=0;a<s.length;++a){var u=s[a];if(!i[u]){i[u]=!0;var c=Object.getOwnPropertyDescriptor(e,u);null!=c&&null==c.get&&null==c.set&&o.push(u)}}e=n.getPrototypeOf(e)}return o}}var o={}.hasOwnProperty;return function(r){if(t(r))return[];var n=[];e:for(var i in r)if(o.call(r,i))n.push(i);else{for(var s=0;s<e.length;++s)if(o.call(e[s],i))continue e;n.push(i)}return n}}(),g=/this\s*\.\s*\S+\s*=/;function b(e){try{if("function"==typeof e){var t=n.names(e.prototype),r=n.isES5&&t.length>1,o=t.length>0&&!(1===t.length&&"constructor"===t[0]),i=g.test(e+"")&&n.names(e).length>0;if(r||o||i)return!0}return!1}catch(e){return!1}}function w(e){function t(){}t.prototype=e;var r=new t;function n(){return typeof r.foo}return n(),n(),e}var k=/^[a-z$_][a-z$_0-9]*$/i;function C(e){return k.test(e)}function x(e,t,r){for(var n=new Array(e),o=0;o<e;++o)n[o]=t+o+r;return n}function j(e){try{return e+""}catch(e){return"[no string representation]"}}function E(e){return e instanceof Error||null!==e&&"object"==typeof e&&"string"==typeof e.message&&"string"==typeof e.name}function S(e){try{v(e,"isOperational",!0)}catch(e){}}function O(e){return null!=e&&(e instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===e.isOperational)}function T(e){return E(e)&&n.propertyIsWritable(e,"stack")}var R="stack"in new Error?function(e){return T(e)?e:new Error(j(e))}:function(e){if(T(e))return e;try{throw new Error(j(e))}catch(e){return e}};function P(e){return{}.toString.call(e)}function F(e,t,r){for(var o=n.names(e),i=0;i<o.length;++i){var s=o[i];if(r(s))try{n.defineProperty(t,s,n.getDescriptor(e,s))}catch(e){}}}var A=function(e){return n.isArray(e)?e:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var H="function"==typeof Array.from?function(e){return Array.from(e)}:function(e){for(var t,r=[],n=e[Symbol.iterator]();!(t=n.next()).done;)r.push(t.value);return r};A=function(e){return n.isArray(e)?e:null!=e&&"function"==typeof e[Symbol.iterator]?H(e):null}}var q="undefined"!=typeof process&&"[object process]"===P(process).toLowerCase(),D="undefined"!=typeof process&&void 0!==process.env,N;function L(e){return D?process.env[e]:void 0}function U(){if("function"==typeof Promise)try{if("[object Promise]"===P(new Promise((function(){}))))return Promise}catch(e){}}function M(e,t){if(null===e||"function"!=typeof t||t===N)return t;null!==e.domain&&(t=e.domain.bind(t));var r=e.async;if(null!==r){var n=t;t=function(){for(var e=arguments.length+2,t=new Array(e),o=2;o<e;++o)t[o]=arguments[o-2];return t[0]=n,t[1]=this,r.runInAsyncScope.apply(r,t)}}return t}var I={setReflectHandler:function(e){N=e},isClass:b,isIdentifier:C,inheritedDataKeys:m,getDataPropertyOrDefault:_,thrower:y,isArray:n.isArray,asArray:A,notEnumerableProp:v,isPrimitive:h,isObject:p,isError:E,canEvaluate:o,errorObj:i,tryCatch:c,inherits:l,withAppended:d,maybeWrapAsError:f,toFastProperties:w,filledRange:x,toString:j,canAttachTrace:T,ensureErrorObject:R,originatesFromRejection:O,markAsOriginatingFromRejection:S,classString:P,copyDescriptors:F,isNode:q,hasEnvVariables:D,env:L,global:a,getNativePromise:U,contextBind:M},B;I.isRecentNode=I.isNode&&(process.versions&&process.versions.node?B=process.versions.node.split(".").map(Number):process.version&&(B=process.version.split(".").map(Number)),0===B[0]&&B[1]>10||B[0]>0),I.nodeSupportsAsyncResource=I.isNode&&function(){var e=!1;try{e="function"==typeof r(14).AsyncResource.prototype.runInAsyncScope}catch(t){e=!1}return e}(),I.isNode&&I.toFastProperties(process);try{throw new Error}catch(e){I.lastLineError=e}e.exports=I},function(e,t,r){"use strict";var n,o,i=r(2),s=i.freeze,a=r(0),u=a.inherits,c=a.notEnumerableProp;function l(e,t){function r(n){if(!(this instanceof r))return new r(n);c(this,"message","string"==typeof n?n:t),c(this,"name",e),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return u(r,Error),r}var h=l("Warning","warning"),p=l("CancellationError","cancellation error"),f=l("TimeoutError","timeout error"),d=l("AggregateError","aggregate error");try{n=TypeError,o=RangeError}catch(e){n=l("TypeError","type error"),o=l("RangeError","range error")}for(var _="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),v=0;v<_.length;++v)"function"==typeof Array.prototype[_[v]]&&(d.prototype[_[v]]=Array.prototype[_[v]]);i.defineProperty(d.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),d.prototype.isOperational=!0;var y=0;function m(e){if(!(this instanceof m))return new m(e);c(this,"name","OperationalError"),c(this,"message",e),this.cause=e,this.isOperational=!0,e instanceof Error?(c(this,"message",e.message),c(this,"stack",e.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}d.prototype.toString=function(){var e=Array(4*y+1).join(" "),t="\n"+e+"AggregateError of:\n";y++,e=Array(4*y+1).join(" ");for(var r=0;r<this.length;++r){for(var n=this[r]===this?"[Circular AggregateError]":this[r]+"",o=n.split("\n"),i=0;i<o.length;++i)o[i]=e+o[i];t+=(n=o.join("\n"))+"\n"}return y--,t},u(m,Error);var g=Error.__BluebirdErrorTypes__;g||(g=s({CancellationError:p,TimeoutError:f,OperationalError:m,RejectionError:m,AggregateError:d}),i.defineProperty(Error,"__BluebirdErrorTypes__",{value:g,writable:!1,enumerable:!1,configurable:!1})),e.exports={Error:Error,TypeError:n,RangeError:o,CancellationError:g.CancellationError,OperationalError:g.OperationalError,TimeoutError:g.TimeoutError,AggregateError:g.AggregateError,Warning:h}},function(e,t){var r=function(){"use strict";return void 0===this}();if(r)e.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:r,propertyIsWritable:function(e,t){var r=Object.getOwnPropertyDescriptor(e,t);return!(r&&!r.writable&&!r.set)}};else{var n={}.hasOwnProperty,o={}.toString,i={}.constructor.prototype,s=function(e){var t=[];for(var r in e)n.call(e,r)&&t.push(r);return t};e.exports={isArray:function(e){try{return"[object Array]"===o.call(e)}catch(e){return!1}},keys:s,names:s,defineProperty:function(e,t,r){return e[t]=r.value,e},getDescriptor:function(e,t){return{value:e[t]}},freeze:function(e){return e},getPrototypeOf:function(e){try{return Object(e).constructor.prototype}catch(e){return i}},isES5:r,propertyIsWritable:function(){return!0}}}},function(e,t){e.exports=require("crypto")},function(e,t,r){"use strict";var n;"undefined"!=typeof Promise&&(n=Promise);var o=r(25)();o.noConflict=function(){try{Promise===o&&(Promise=n)}catch(e){}return o},e.exports=o},function(e,t){e.exports=require("safe-buffer")},function(e,t){e.exports=require("url")},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(t){var r=e.call(this,t)||this;return r.name="YandexDiskManagerError",r}return o(t,e),t}(Error);t.default=i},function(e,t){e.exports=require("querystring")},function(e,t){e.exports=require("extend")},function(e,t,r){"use strict";var n=r(60),o=r(3),i=r(5).Buffer,s="undefined"==typeof setImmediate?process.nextTick:setImmediate;t.paramsHaveRequestBody=function(e){return e.body||e.requestBodyStream||e.json&&"boolean"!=typeof e.json||e.multipart},t.safeStringify=function(e,t){var r;try{r=JSON.stringify(e,t)}catch(o){r=n(e,t)}return r},t.md5=function(e){return o.createHash("md5").update(e).digest("hex")},t.isReadStream=function(e){return e.readable&&e.path&&e.mode},t.toBase64=function(e){return i.from(e||"","utf8").toString("base64")},t.copy=function(e){var t={};return Object.keys(e).forEach((function(r){t[r]=e[r]})),t},t.version=function(){var e=process.version.replace("v","").split(".");return{major:parseInt(e[0],10),minor:parseInt(e[1],10),patch:parseInt(e[2],10)}},t.defer=s},function(e,t){e.exports=require("caseless")},function(e,t){e.exports=require("uuid/v4")},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},s=this&&this.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r},a=this&&this.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)n[o]=i[s];return n},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c,l=u(r(3)),h=u(r(8)),p=u(r(4)),f=u(r(55)),d=r(89),_=u(r(22)),v=u(r(23)),y=u(r(7));!function(e){e.Name="name",e.Path="path",e.Created="created",e.Modified="modified",e.Size="size"}(c=t.SortBy||(t.SortBy={})),function(e){e.Dir="dir",e.File="file"}(t.ResourceType||(t.ResourceType={}));var m=function(){function e(e){this._token=e}return Object.defineProperty(e.prototype,"token",{get:function(){return this._token},enumerable:!0,configurable:!0}),e.prototype.getStatus=function(){return o(this,void 0,void 0,(function(){var t,r,n,o,s,a;return i(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,f.default(e.BASE_API_URL,{method:"GET",headers:{authorization:"OAuth "+this._token}})];case 1:return t=i.sent(),r=JSON.parse(t),n=r.total_space,o=r.used_space,s=r.max_file_size,[2,{id:r.user.uid,totalSpace:n,usedSpace:o,maxFileSize:s}];case 2:if((a=i.sent())instanceof d.StatusCodeError)switch(a.statusCode){case 401:throw new y.default("Could not connect to API.");default:throw new y.default(JSON.parse(a.error).description)}throw new y.default("Unknown error.");case 3:return[2]}}))}))},e.prototype.createDir=function(t){return o(this,void 0,void 0,(function(){var r,n,o,s;return i(this,(function(i){switch(i.label){case 0:r=h.default.stringify({path:t}),n=e.BASE_API_URL+"/resources?"+r,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,f.default(n,{method:"PUT",headers:{authorization:"OAuth "+this._token}})];case 2:return o=i.sent(),[2,JSON.parse(o).href];case 3:if((s=i.sent())instanceof d.StatusCodeError)switch(s.statusCode){case 401:throw new y.default("Could not connect to API.");case 409:throw new y.default("Resource already exists.");default:throw new y.default(JSON.parse(s.error).description)}throw new y.default("Unknown error.");case 4:return[2]}}))}))},e.prototype.getDirList=function(t,r){var u,l;return void 0===r&&(r={offset:0,limit:20,sort:c.Created}),o(this,void 0,void 0,(function(){var o,c,p,_,v,m;return i(this,(function(i){switch(i.label){case 0:o=a(["sort"],["name","size","type","media_type","created","modified"].map((function(e){return"items."+e}))).map((function(e){return"_embedded."+e})).join(","),c=h.default.stringify(n(n({path:t},r),{fields:o})),p=e.BASE_API_URL+"/resources?"+c,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,f.default(p,{method:"GET",headers:{authorization:"OAuth "+this._token}})];case 2:if(_=i.sent(),!(v=null===(l=null===(u=JSON.parse(_))||void 0===u?void 0:u._embedded)||void 0===l?void 0:l.items))throw new y.default("Resource is not a directory.");return[2,v.map((function(e){var t=e.created,r=e.modified,o=e.media_type,i=s(e,["created","modified","media_type"]),a=n(n({},i),{createdAt:new Date(t),updatedAt:new Date(r)});return o&&(a.mediaType=o),a}))];case 3:if((m=i.sent())instanceof y.default)throw m;if(m instanceof d.StatusCodeError)switch(m.statusCode){case 401:throw new y.default("Could not connect to API.");default:throw new y.default(JSON.parse(m.error).description)}throw new y.default("Unknown error.");case 4:return[2]}}))}))},e.prototype.getFileLink=function(t){return o(this,void 0,void 0,(function(){var r,n,o,s,a;return i(this,(function(i){switch(i.label){case 0:r=h.default.stringify({path:t}),n=e.BASE_API_URL+"/resources/download?"+r,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,f.default(n,{method:"GET",headers:{authorization:"OAuth "+this._token}})];case 2:if(o=i.sent(),!(s=JSON.parse(o).href))throw new y.default("Unable to get link for disk instance.");return[2,s];case 3:if((a=i.sent())instanceof y.default)throw a;if(a instanceof d.StatusCodeError)switch(a.statusCode){case 401:throw new y.default("Could not connect to API.");default:throw new y.default(JSON.parse(a.error).description)}throw new y.default("Unknown error.");case 4:return[2]}}))}))},e.prototype.uploadFile=function(t,r){var n,s,a,u,c;return o(this,void 0,void 0,(function(){var o,m,g,b,w,k,C,x,j;return i(this,(function(i){switch(i.label){case 0:return[4,_.default(t)];case 1:o=i.sent(),m=(null===(n=r)||void 0===n?void 0:n.fileName)||l.default.createHash("sha256").update(o).digest("hex"),(g=null===(s=r)||void 0===s?void 0:s.extension)&&(g=(g.startsWith(".")?"":".")+g),b=""+m+(g||""),w=((null===(a=r)||void 0===a?void 0:a.path)||"")+((null===(c=null===(u=r)||void 0===u?void 0:u.path)||void 0===c?void 0:c.endsWith("/"))?"":"/")+b,k=h.default.stringify({path:w}),C=e.BASE_API_URL+"/resources/upload/?"+k,i.label=2;case 2:return i.trys.push([2,4,,5]),[4,f.default(C,{method:"GET",headers:{authorization:"OAuth "+this._token}})];case 3:return x=i.sent(),[2,new p.default((function(e,t){v.default(o).pipe(f.default.put(JSON.parse(x).href)).on("complete",(function(){e(w)})).on("error",(function(){t(new y.default("Error while upload."))}))}))];case 4:if((j=i.sent())instanceof d.StatusCodeError)switch(j.statusCode){case 401:throw new y.default("Could not connect to API.");default:throw new y.default(JSON.parse(j.error).description)}throw new y.default("Unknown error.");case 5:return[2]}}))}))},e.prototype.removeFile=function(t){return o(this,void 0,void 0,(function(){var r,n,o;return i(this,(function(i){switch(i.label){case 0:r=h.default.stringify({path:t,permanently:!0}),n=e.BASE_API_URL+"/resources?"+r,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,f.default(n,{method:"DELETE",headers:{authorization:"OAuth "+this._token}})];case 2:return i.sent(),[2,!0];case 3:if((o=i.sent())instanceof d.StatusCodeError)switch(o.statusCode){case 401:throw new y.default("Could not connect to API.");case 409:throw new y.default("Unable to remove disk instance.");default:throw new y.default(JSON.parse(o.error).description)}throw new y.default("Unknown error.");case 4:return[2]}}))}))},e.BASE_API_URL="https://cloud-api.yandex.net/v1/disk",e}();t.default=m},function(e,t){e.exports=require("async_hooks")},function(e,t,r){"use strict";e.exports=function(e){var t=r(0),n=r(2).keys,o=t.tryCatch,i=t.errorObj;return function(r,s,a){return function(u){var c=a._boundValue();e:for(var l=0;l<r.length;++l){var h=r[l];if(h===Error||null!=h&&h.prototype instanceof Error){if(u instanceof h)return o(s).call(c,u)}else if("function"==typeof h){var p=o(h).call(c,u);if(p===i)return p;if(p)return o(s).call(c,u)}else if(t.isObject(u)){for(var f=n(h),d=0;d<f.length;++d){var _=f[d];if(h[_]!=u[_])continue e}return o(s).call(c,u)}}return e}}}},function(e,t,r){"use strict";var n=r(0),o=n.maybeWrapAsError,i=r(1).OperationalError,s=r(2);var a=/^(?:name|message|stack|cause)$/;function u(e){var t;if(function(e){return e instanceof Error&&s.getPrototypeOf(e)===Error.prototype}(e)){(t=new i(e)).name=e.name,t.message=e.message,t.stack=e.stack;for(var r=s.keys(e),o=0;o<r.length;++o){var u=r[o];a.test(u)||(t[u]=e[u])}return t}return n.markAsOriginatingFromRejection(e),e}e.exports=function(e,t){return function(r,n){if(null!==e){if(r){var i=u(o(r));e._attachExtraTrace(i),e._reject(i)}else if(t){for(var s=arguments.length,a=new Array(Math.max(s-1,0)),c=1;c<s;++c)a[c-1]=arguments[c];e._fulfill(a)}else e._fulfill(n);e=null}}}},function(e,t,r){"use strict";var n=r(18),o=n.Cookie,i=n.CookieJar;function s(e){this._jar=new i(e,{looseMode:!0})}t.parse=function(e){if(e&&e.uri&&(e=e.uri),"string"!=typeof e)throw new Error("The cookie function only accepts STRING as param");return o.parse(e,{loose:!0})},s.prototype.setCookie=function(e,t,r){return this._jar.setCookieSync(e,t,r||{})},s.prototype.getCookieString=function(e){return this._jar.getCookieStringSync(e)},s.prototype.getCookies=function(e){return this._jar.getCookiesSync(e)},t.jar=function(e){return new s(e)}},function(e,t){e.exports=require("tough-cookie")},function(e,t){e.exports=require("stream")},function(e,t){e.exports=require("isstream")},function(e,t){e.exports=require("qs")},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(4));t.default=function(e){return new o.default((function(t,r){var n=[];e.on("data",(function(e){n.push(e)})),e.on("end",(function(){t(Buffer.concat(n))})),e.on("error",(function(e){r(e)}))}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(19);t.default=function(e){var t=new n.Duplex;return t.push(e),t.push(null),t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(7);t.DiskManagerError=n.default;var o=r(13);t.DiskInstance=o.default,t.SortBy=o.SortBy,t.ResourceType=o.ResourceType;var i=r(91);t.default=i.default},function(e,t,r){"use strict";e.exports=function(){var t=function(){return new y("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},n=function(){return new F.PromiseInspection(this._target())},o=function(e){return F.reject(new y(e))};function i(){}var s={},a=r(0);a.setReflectHandler(n);var u=function(){var e=process.domain;return void 0===e?null:e},c=function(){return{domain:u(),async:null}},l=a.isNode&&a.nodeSupportsAsyncResource?r(14).AsyncResource:null,h=function(){return{domain:u(),async:new l("Bluebird::Promise")}},p=a.isNode?c:function(){return null};a.notEnumerableProp(F,"_getContext",p);var f=r(2),d=r(26),_=new d;f.defineProperty(F,"_async",{value:_});var v=r(1),y=F.TypeError=v.TypeError;F.RangeError=v.RangeError;var m=F.CancellationError=v.CancellationError;F.TimeoutError=v.TimeoutError,F.OperationalError=v.OperationalError,F.RejectionError=v.OperationalError,F.AggregateError=v.AggregateError;var g=function(){},b={},w={},k=r(29)(F,g),C=r(30)(F,g,k,o,i),x=r(31)(F),j=x.create,E=r(32)(F,x,(function(){p=h,a.notEnumerableProp(F,"_getContext",h)}),(function(){p=c,a.notEnumerableProp(F,"_getContext",c)})),S=(E.CapturedTrace,r(33)(F,k,w)),O=r(15)(w),T=r(16),R=a.errorObj,P=a.tryCatch;function F(e){e!==g&&function(e,t){if(null==e||e.constructor!==F)throw new y("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n");if("function"!=typeof t)throw new y("expecting a function but got "+a.classString(t))}(this,e),this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._resolveFromExecutor(e),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function A(e){this.promise._resolveCallback(e)}function H(e){this.promise._rejectCallback(e,!1)}function q(e){var t=new F(g);t._fulfillmentHandler0=e,t._rejectionHandler0=e,t._promise0=e,t._receiver0=e}return F.prototype.toString=function(){return"[object Promise]"},F.prototype.caught=F.prototype.catch=function(e){var t=arguments.length;if(t>1){var r,n=new Array(t-1),i=0;for(r=0;r<t-1;++r){var s=arguments[r];if(!a.isObject(s))return o("Catch statement predicate: expecting an object but got "+a.classString(s));n[i++]=s}if(n.length=i,"function"!=typeof(e=arguments[r]))throw new y("The last argument to .catch() must be a function, got "+a.toString(e));return this.then(void 0,O(n,e,this))}return this.then(void 0,e)},F.prototype.reflect=function(){return this._then(n,n,void 0,this,void 0)},F.prototype.then=function(e,t){if(E.warnings()&&arguments.length>0&&"function"!=typeof e&&"function"!=typeof t){var r=".then() only accepts functions but was passed: "+a.classString(e);arguments.length>1&&(r+=", "+a.classString(t)),this._warn(r)}return this._then(e,t,void 0,void 0,void 0)},F.prototype.done=function(e,t){this._then(e,t,void 0,void 0,void 0)._setIsFinal()},F.prototype.spread=function(e){return"function"!=typeof e?o("expecting a function but got "+a.classString(e)):this.all()._then(e,void 0,void 0,b,void 0)},F.prototype.toJSON=function(){var e={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(e.fulfillmentValue=this.value(),e.isFulfilled=!0):this.isRejected()&&(e.rejectionReason=this.reason(),e.isRejected=!0),e},F.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new C(this).promise()},F.prototype.error=function(e){return this.caught(a.originatesFromRejection,e)},F.getNewLibraryCopy=e.exports,F.is=function(e){return e instanceof F},F.fromNode=F.fromCallback=function(e){var t=new F(g);t._captureStackTrace();var r=arguments.length>1&&!!Object(arguments[1]).multiArgs,n=P(e)(T(t,r));return n===R&&t._rejectCallback(n.e,!0),t._isFateSealed()||t._setAsyncGuaranteed(),t},F.all=function(e){return new C(e).promise()},F.cast=function(e){var t=k(e);return t instanceof F||((t=new F(g))._captureStackTrace(),t._setFulfilled(),t._rejectionHandler0=e),t},F.resolve=F.fulfilled=F.cast,F.reject=F.rejected=function(e){var t=new F(g);return t._captureStackTrace(),t._rejectCallback(e,!0),t},F.setScheduler=function(e){if("function"!=typeof e)throw new y("expecting a function but got "+a.classString(e));return _.setScheduler(e)},F.prototype._then=function(e,t,r,n,o){var i=void 0!==o,s=i?o:new F(g),u=this._target(),c=u._bitField;i||(s._propagateFrom(this,3),s._captureStackTrace(),void 0===n&&0!=(2097152&this._bitField)&&(n=0!=(50397184&c)?this._boundValue():u===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,s));var l=p();if(0!=(50397184&c)){var h,f,d=u._settlePromiseCtx;0!=(33554432&c)?(f=u._rejectionHandler0,h=e):0!=(16777216&c)?(f=u._fulfillmentHandler0,h=t,u._unsetRejectionIsUnhandled()):(d=u._settlePromiseLateCancellationObserver,f=new m("late cancellation observer"),u._attachExtraTrace(f),h=t),_.invoke(d,u,{handler:a.contextBind(l,h),promise:s,receiver:n,value:f})}else u._addCallbacks(e,t,s,n,l);return s},F.prototype._length=function(){return 65535&this._bitField},F.prototype._isFateSealed=function(){return 0!=(117506048&this._bitField)},F.prototype._isFollowing=function(){return 67108864==(67108864&this._bitField)},F.prototype._setLength=function(e){this._bitField=-65536&this._bitField|65535&e},F.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},F.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},F.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},F.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},F.prototype._isFinal=function(){return(4194304&this._bitField)>0},F.prototype._unsetCancelled=function(){this._bitField=-65537&this._bitField},F.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},F.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},F.prototype._setAsyncGuaranteed=function(){if(!_.hasCustomScheduler()){var e=this._bitField;this._bitField=e|(536870912&e)>>2^134217728}},F.prototype._setNoAsyncGuarantee=function(){this._bitField=-134217729&(536870912|this._bitField)},F.prototype._receiverAt=function(e){var t=0===e?this._receiver0:this[4*e-4+3];if(t!==s)return void 0===t&&this._isBound()?this._boundValue():t},F.prototype._promiseAt=function(e){return this[4*e-4+2]},F.prototype._fulfillmentHandlerAt=function(e){return this[4*e-4+0]},F.prototype._rejectionHandlerAt=function(e){return this[4*e-4+1]},F.prototype._boundValue=function(){},F.prototype._migrateCallback0=function(e){e._bitField;var t=e._fulfillmentHandler0,r=e._rejectionHandler0,n=e._promise0,o=e._receiverAt(0);void 0===o&&(o=s),this._addCallbacks(t,r,n,o,null)},F.prototype._migrateCallbackAt=function(e,t){var r=e._fulfillmentHandlerAt(t),n=e._rejectionHandlerAt(t),o=e._promiseAt(t),i=e._receiverAt(t);void 0===i&&(i=s),this._addCallbacks(r,n,o,i,null)},F.prototype._addCallbacks=function(e,t,r,n,o){var i=this._length();if(i>=65531&&(i=0,this._setLength(0)),0===i)this._promise0=r,this._receiver0=n,"function"==typeof e&&(this._fulfillmentHandler0=a.contextBind(o,e)),"function"==typeof t&&(this._rejectionHandler0=a.contextBind(o,t));else{var s=4*i-4;this[s+2]=r,this[s+3]=n,"function"==typeof e&&(this[s+0]=a.contextBind(o,e)),"function"==typeof t&&(this[s+1]=a.contextBind(o,t))}return this._setLength(i+1),i},F.prototype._proxy=function(e,t){this._addCallbacks(void 0,void 0,t,e,null)},F.prototype._resolveCallback=function(e,r){if(0==(117506048&this._bitField)){if(e===this)return this._rejectCallback(t(),!1);var n=k(e,this);if(!(n instanceof F))return this._fulfill(e);r&&this._propagateFrom(n,2);var o=n._target();if(o!==this){var i=o._bitField;if(0==(50397184&i)){var s=this._length();s>0&&o._migrateCallback0(this);for(var a=1;a<s;++a)o._migrateCallbackAt(this,a);this._setFollowing(),this._setLength(0),this._setFollowee(n)}else if(0!=(33554432&i))this._fulfill(o._value());else if(0!=(16777216&i))this._reject(o._reason());else{var u=new m("late cancellation observer");o._attachExtraTrace(u),this._reject(u)}}else this._reject(t())}},F.prototype._rejectCallback=function(e,t,r){var n=a.ensureErrorObject(e),o=n===e;if(!o&&!r&&E.warnings()){var i="a promise was rejected with a non-error: "+a.classString(e);this._warn(i,!0)}this._attachExtraTrace(n,!!t&&o),this._reject(e)},F.prototype._resolveFromExecutor=function(e){if(e!==g){var t=this;this._captureStackTrace(),this._pushContext();var r=!0,n=this._execute(e,(function(e){t._resolveCallback(e)}),(function(e){t._rejectCallback(e,r)}));r=!1,this._popContext(),void 0!==n&&t._rejectCallback(n,!0)}},F.prototype._settlePromiseFromHandler=function(e,t,r,n){var o=n._bitField;if(0==(65536&o)){var i;n._pushContext(),t===b?r&&"number"==typeof r.length?i=P(e).apply(this._boundValue(),r):(i=R).e=new y("cannot .spread() a non-array: "+a.classString(r)):i=P(e).call(t,r);var s=n._popContext();0==(65536&(o=n._bitField))&&(i===w?n._reject(r):i===R?n._rejectCallback(i.e,!1):(E.checkForgottenReturns(i,s,"",n,this),n._resolveCallback(i)))}},F.prototype._target=function(){for(var e=this;e._isFollowing();)e=e._followee();return e},F.prototype._followee=function(){return this._rejectionHandler0},F.prototype._setFollowee=function(e){this._rejectionHandler0=e},F.prototype._settlePromise=function(e,t,r,o){var s=e instanceof F,a=this._bitField,u=0!=(134217728&a);0!=(65536&a)?(s&&e._invokeInternalOnCancel(),r instanceof S&&r.isFinallyHandler()?(r.cancelPromise=e,P(t).call(r,o)===R&&e._reject(R.e)):t===n?e._fulfill(n.call(r)):r instanceof i?r._promiseCancelled(e):s||e instanceof C?e._cancel():r.cancel()):"function"==typeof t?s?(u&&e._setAsyncGuaranteed(),this._settlePromiseFromHandler(t,r,o,e)):t.call(r,o,e):r instanceof i?r._isResolved()||(0!=(33554432&a)?r._promiseFulfilled(o,e):r._promiseRejected(o,e)):s&&(u&&e._setAsyncGuaranteed(),0!=(33554432&a)?e._fulfill(o):e._reject(o))},F.prototype._settlePromiseLateCancellationObserver=function(e){var t=e.handler,r=e.promise,n=e.receiver,o=e.value;"function"==typeof t?r instanceof F?this._settlePromiseFromHandler(t,n,o,r):t.call(n,o,r):r instanceof F&&r._reject(o)},F.prototype._settlePromiseCtx=function(e){this._settlePromise(e.promise,e.handler,e.receiver,e.value)},F.prototype._settlePromise0=function(e,t,r){var n=this._promise0,o=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(n,e,o,t)},F.prototype._clearCallbackDataAtIndex=function(e){var t=4*e-4;this[t+2]=this[t+3]=this[t+0]=this[t+1]=void 0},F.prototype._fulfill=function(e){var r=this._bitField;if(!((117506048&r)>>>16)){if(e===this){var n=t();return this._attachExtraTrace(n),this._reject(n)}this._setFulfilled(),this._rejectionHandler0=e,(65535&r)>0&&(0!=(134217728&r)?this._settlePromises():_.settlePromises(this),this._dereferenceTrace())}},F.prototype._reject=function(e){var t=this._bitField;if(!((117506048&t)>>>16)){if(this._setRejected(),this._fulfillmentHandler0=e,this._isFinal())return _.fatalError(e,a.isNode);(65535&t)>0?_.settlePromises(this):this._ensurePossibleRejectionHandled()}},F.prototype._fulfillPromises=function(e,t){for(var r=1;r<e;r++){var n=this._fulfillmentHandlerAt(r),o=this._promiseAt(r),i=this._receiverAt(r);this._clearCallbackDataAtIndex(r),this._settlePromise(o,n,i,t)}},F.prototype._rejectPromises=function(e,t){for(var r=1;r<e;r++){var n=this._rejectionHandlerAt(r),o=this._promiseAt(r),i=this._receiverAt(r);this._clearCallbackDataAtIndex(r),this._settlePromise(o,n,i,t)}},F.prototype._settlePromises=function(){var e=this._bitField,t=65535&e;if(t>0){if(0!=(16842752&e)){var r=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,r,e),this._rejectPromises(t,r)}else{var n=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,n,e),this._fulfillPromises(t,n)}this._setLength(0)}this._clearCancellationData()},F.prototype._settledValue=function(){var e=this._bitField;return 0!=(33554432&e)?this._rejectionHandler0:0!=(16777216&e)?this._fulfillmentHandler0:void 0},"undefined"!=typeof Symbol&&Symbol.toStringTag&&f.defineProperty(F.prototype,Symbol.toStringTag,{get:function(){return"Object"}}),F.defer=F.pending=function(){return E.deprecated("Promise.defer","new Promise"),{promise:new F(g),resolve:A,reject:H}},a.notEnumerableProp(F,"_makeSelfResolutionError",t),r(34)(F,g,k,o,E),r(35)(F,g,k,E),r(36)(F,C,o,E),r(37)(F),r(38)(F),r(39)(F,C,k,g,_),F.Promise=F,F.version="3.7.2",r(40)(F),r(41)(F,o,g,k,i,E),r(42)(F,C,o,k,g,E),r(43)(F),r(44)(F,g),r(45)(F,C,k,o),r(46)(F,g,k,o),r(47)(F,C,o,k,g,E),r(48)(F,C,E),r(49)(F,C,o),r(50)(F,g,E),r(51)(F,o,k,j,g,E),r(52)(F),r(53)(F,g),r(54)(F,g),a.toFastProperties(F),a.toFastProperties(F.prototype),q({a:1}),q({b:2}),q({c:3}),q(1),q((function(){})),q(void 0),q(!1),q(new F(g)),E.setBounds(d.firstLineError,a.lastLineError),F}},function(e,t,r){"use strict";var n;try{throw new Error}catch(e){n=e}var o=r(27),i=r(28);function s(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new i(16),this._normalQueue=new i(16),this._haveDrainedQueues=!1;var e=this;this.drainQueues=function(){e._drainQueues()},this._schedule=o}function a(e){for(;e.length()>0;)u(e)}function u(e){var t=e.shift();if("function"!=typeof t)t._settlePromises();else{var r=e.shift(),n=e.shift();t.call(r,n)}}s.prototype.setScheduler=function(e){var t=this._schedule;return this._schedule=e,this._customScheduler=!0,t},s.prototype.hasCustomScheduler=function(){return this._customScheduler},s.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},s.prototype.fatalError=function(e,t){t?(process.stderr.write("Fatal "+(e instanceof Error?e.stack:e)+"\n"),process.exit(2)):this.throwLater(e)},s.prototype.throwLater=function(e,t){if(1===arguments.length&&(t=e,e=function(){throw t}),"undefined"!=typeof setTimeout)setTimeout((function(){e(t)}),0);else try{this._schedule((function(){e(t)}))}catch(e){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},s.prototype.invokeLater=function(e,t,r){this._lateQueue.push(e,t,r),this._queueTick()},s.prototype.invoke=function(e,t,r){this._normalQueue.push(e,t,r),this._queueTick()},s.prototype.settlePromises=function(e){this._normalQueue._pushOne(e),this._queueTick()},s.prototype._drainQueues=function(){a(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,a(this._lateQueue)},s.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},s.prototype._reset=function(){this._isTickUsed=!1},e.exports=s,e.exports.firstLineError=n},function(e,t,r){"use strict";var n,o=r(0),i=o.getNativePromise();if(o.isNode&&"undefined"==typeof MutationObserver){var s=global.setImmediate,a=process.nextTick;n=o.isRecentNode?function(e){s.call(global,e)}:function(e){a.call(process,e)}}else if("function"==typeof i&&"function"==typeof i.resolve){var u=i.resolve();n=function(e){u.then(e)}}else n="undefined"!=typeof MutationObserver&&("undefined"==typeof window||!window.navigator||!window.navigator.standalone&&!window.cordova)&&"classList"in document.documentElement?function(){var e=document.createElement("div"),t={attributes:!0},r=!1,n=document.createElement("div");new MutationObserver((function(){e.classList.toggle("foo"),r=!1})).observe(n,t);return function(o){var i=new MutationObserver((function(){i.disconnect(),o()}));i.observe(e,t),r||(r=!0,n.classList.toggle("foo"))}}():"undefined"!=typeof setImmediate?function(e){setImmediate(e)}:"undefined"!=typeof setTimeout?function(e){setTimeout(e,0)}:function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")};e.exports=n},function(e,t,r){"use strict";function n(e){this._capacity=e,this._length=0,this._front=0}n.prototype._willBeOverCapacity=function(e){return this._capacity<e},n.prototype._pushOne=function(e){var t=this.length();this._checkCapacity(t+1),this[this._front+t&this._capacity-1]=e,this._length=t+1},n.prototype.push=function(e,t,r){var n=this.length()+3;if(this._willBeOverCapacity(n))return this._pushOne(e),this._pushOne(t),void this._pushOne(r);var o=this._front+n-3;this._checkCapacity(n);var i=this._capacity-1;this[o+0&i]=e,this[o+1&i]=t,this[o+2&i]=r,this._length=n},n.prototype.shift=function(){var e=this._front,t=this[e];return this[e]=void 0,this._front=e+1&this._capacity-1,this._length--,t},n.prototype.length=function(){return this._length},n.prototype._checkCapacity=function(e){this._capacity<e&&this._resizeTo(this._capacity<<1)},n.prototype._resizeTo=function(e){var t=this._capacity;this._capacity=e,function(e,t,r,n,o){for(var i=0;i<o;++i)r[i+n]=e[i+t],e[i+t]=void 0}(this,0,this,t,this._front+this._length&t-1)},e.exports=n},function(e,t,r){"use strict";e.exports=function(e,t){var n=r(0),o=n.errorObj,i=n.isObject;var s={}.hasOwnProperty;return function(r,a){if(i(r)){if(r instanceof e)return r;var u=function(e){try{return function(e){return e.then}(e)}catch(e){return o.e=e,o}}(r);if(u===o){a&&a._pushContext();var c=e.reject(u.e);return a&&a._popContext(),c}if("function"==typeof u){if(function(e){try{return s.call(e,"_promise0")}catch(e){return!1}}(r)){c=new e(t);return r._then(c._fulfill,c._reject,void 0,c,null),c}return function(r,i,s){var a=new e(t),u=a;s&&s._pushContext();a._captureStackTrace(),s&&s._popContext();var c=n.tryCatch(i).call(r,(function(e){if(!a)return;a._resolveCallback(e),a=null}),(function(e){if(!a)return;a._rejectCallback(e,!1,!0),a=null}));!1,a&&c===o&&(a._rejectCallback(c.e,!0,!0),a=null);return u}(r,u,a)}}return r}}},function(e,t,r){"use strict";e.exports=function(e,t,n,o,i){var s=r(0);s.isArray;function a(r){var n=this._promise=new e(t);r instanceof e&&(n._propagateFrom(r,3),r.suppressUnhandledRejections()),n._setOnCancel(this),this._values=r,this._length=0,this._totalResolved=0,this._init(void 0,-2)}return s.inherits(a,i),a.prototype.length=function(){return this._length},a.prototype.promise=function(){return this._promise},a.prototype._init=function t(r,i){var a=n(this._values,this._promise);if(a instanceof e){var u=(a=a._target())._bitField;if(this._values=a,0==(50397184&u))return this._promise._setAsyncGuaranteed(),a._then(t,this._reject,void 0,this,i);if(0==(33554432&u))return 0!=(16777216&u)?this._reject(a._reason()):this._cancel();a=a._value()}if(null!==(a=s.asArray(a)))0!==a.length?this._iterate(a):-5===i?this._resolveEmptyArray():this._resolve(function(e){switch(e){case-2:return[];case-3:return{};case-6:return new Map}}(i));else{var c=o("expecting an array or an iterable object but got "+s.classString(a)).reason();this._promise._rejectCallback(c,!1)}},a.prototype._iterate=function(t){var r=this.getActualLength(t.length);this._length=r,this._values=this.shouldCopyValues()?new Array(r):this._values;for(var o=this._promise,i=!1,s=null,a=0;a<r;++a){var u=n(t[a],o);s=u instanceof e?(u=u._target())._bitField:null,i?null!==s&&u.suppressUnhandledRejections():null!==s?0==(50397184&s)?(u._proxy(this,a),this._values[a]=u):i=0!=(33554432&s)?this._promiseFulfilled(u._value(),a):0!=(16777216&s)?this._promiseRejected(u._reason(),a):this._promiseCancelled(a):i=this._promiseFulfilled(u,a)}i||o._setAsyncGuaranteed()},a.prototype._isResolved=function(){return null===this._values},a.prototype._resolve=function(e){this._values=null,this._promise._fulfill(e)},a.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},a.prototype._reject=function(e){this._values=null,this._promise._rejectCallback(e,!1)},a.prototype._promiseFulfilled=function(e,t){return this._values[t]=e,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},a.prototype._promiseCancelled=function(){return this._cancel(),!0},a.prototype._promiseRejected=function(e){return this._totalResolved++,this._reject(e),!0},a.prototype._resultCancelled=function(){if(!this._isResolved()){var t=this._values;if(this._cancel(),t instanceof e)t.cancel();else for(var r=0;r<t.length;++r)t[r]instanceof e&&t[r].cancel()}},a.prototype.shouldCopyValues=function(){return!0},a.prototype.getActualLength=function(e){return e},a}},function(e,t,r){"use strict";e.exports=function(e){var t=!1,r=[];function n(){this._trace=new n.CapturedTrace(o())}function o(){var e=r.length-1;if(e>=0)return r[e]}return e.prototype._promiseCreated=function(){},e.prototype._pushContext=function(){},e.prototype._popContext=function(){return null},e._peekContext=e.prototype._peekContext=function(){},n.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,r.push(this._trace))},n.prototype._popContext=function(){if(void 0!==this._trace){var e=r.pop(),t=e._promiseCreated;return e._promiseCreated=null,t}return null},n.CapturedTrace=null,n.create=function(){if(t)return new n},n.deactivateLongStackTraces=function(){},n.activateLongStackTraces=function(){var r=e.prototype._pushContext,i=e.prototype._popContext,s=e._peekContext,a=e.prototype._peekContext,u=e.prototype._promiseCreated;n.deactivateLongStackTraces=function(){e.prototype._pushContext=r,e.prototype._popContext=i,e._peekContext=s,e.prototype._peekContext=a,e.prototype._promiseCreated=u,t=!1},t=!0,e.prototype._pushContext=n.prototype._pushContext,e.prototype._popContext=n.prototype._popContext,e._peekContext=e.prototype._peekContext=o,e.prototype._promiseCreated=function(){var e=this._peekContext();e&&null==e._promiseCreated&&(e._promiseCreated=this)}},n}},function(e,t,r){"use strict";e.exports=function(e,t,n,o){var i,s,a,u,c=e._async,l=r(1).Warning,h=r(0),p=r(2),f=h.canAttachTrace,d=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,_=/\((?:timers\.js):\d+:\d+\)/,v=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,y=null,m=null,g=!1,b=!(0==h.env("BLUEBIRD_DEBUG")||!h.env("BLUEBIRD_DEBUG")&&"development"!==h.env("NODE_ENV")),w=!(0==h.env("BLUEBIRD_WARNINGS")||!b&&!h.env("BLUEBIRD_WARNINGS")),k=!(0==h.env("BLUEBIRD_LONG_STACK_TRACES")||!b&&!h.env("BLUEBIRD_LONG_STACK_TRACES")),C=0!=h.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(w||!!h.env("BLUEBIRD_W_FORGOTTEN_RETURN"));!function(){var t=[];function r(){for(var e=0;e<t.length;++e)t[e]._notifyUnhandledRejection();n()}function n(){t.length=0}u=function(e){t.push(e),setTimeout(r,1)},p.defineProperty(e,"_unhandledRejectionCheck",{value:r}),p.defineProperty(e,"_unhandledRejectionClear",{value:n})}(),e.prototype.suppressUnhandledRejections=function(){var e=this._target();e._bitField=-1048577&e._bitField|524288},e.prototype._ensurePossibleRejectionHandled=function(){0==(524288&this._bitField)&&(this._setRejectionIsUnhandled(),u(this))},e.prototype._notifyUnhandledRejectionIsHandled=function(){$("rejectionHandled",i,void 0,this)},e.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},e.prototype._returnedNonUndefined=function(){return 0!=(268435456&this._bitField)},e.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var e=this._settledValue();this._setUnhandledRejectionIsNotified(),$("unhandledRejection",s,e,this)}},e.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},e.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-262145&this._bitField},e.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},e.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},e.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-1048577&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},e.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},e.prototype._warn=function(e,t,r){return z(e,t,r||this)},e.onPossiblyUnhandledRejection=function(t){var r=e._getContext();s=h.contextBind(r,t)},e.onUnhandledRejectionHandled=function(t){var r=e._getContext();i=h.contextBind(r,t)};var x=function(){};e.longStackTraces=function(){if(c.haveItemsQueued()&&!te.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!te.longStackTraces&&X()){var r=e.prototype._captureStackTrace,n=e.prototype._attachExtraTrace,o=e.prototype._dereferenceTrace;te.longStackTraces=!0,x=function(){if(c.haveItemsQueued()&&!te.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");e.prototype._captureStackTrace=r,e.prototype._attachExtraTrace=n,e.prototype._dereferenceTrace=o,t.deactivateLongStackTraces(),te.longStackTraces=!1},e.prototype._captureStackTrace=M,e.prototype._attachExtraTrace=I,e.prototype._dereferenceTrace=B,t.activateLongStackTraces()}},e.hasLongStackTraces=function(){return te.longStackTraces&&X()};var j={unhandledrejection:{before:function(){var e=h.global.onunhandledrejection;return h.global.onunhandledrejection=null,e},after:function(e){h.global.onunhandledrejection=e}},rejectionhandled:{before:function(){var e=h.global.onrejectionhandled;return h.global.onrejectionhandled=null,e},after:function(e){h.global.onrejectionhandled=e}}},E=function(){var e=function(e,t){if(!e)return!h.global.dispatchEvent(t);var r;try{return r=e.before(),!h.global.dispatchEvent(t)}finally{e.after(r)}};try{if("function"==typeof CustomEvent){var t=new CustomEvent("CustomEvent");return h.global.dispatchEvent(t),function(t,r){t=t.toLowerCase();var n=new CustomEvent(t,{detail:r,cancelable:!0});return p.defineProperty(n,"promise",{value:r.promise}),p.defineProperty(n,"reason",{value:r.reason}),e(j[t],n)}}if("function"==typeof Event){t=new Event("CustomEvent");return h.global.dispatchEvent(t),function(t,r){t=t.toLowerCase();var n=new Event(t,{cancelable:!0});return n.detail=r,p.defineProperty(n,"promise",{value:r.promise}),p.defineProperty(n,"reason",{value:r.reason}),e(j[t],n)}}return(t=document.createEvent("CustomEvent")).initCustomEvent("testingtheevent",!1,!0,{}),h.global.dispatchEvent(t),function(t,r){t=t.toLowerCase();var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!0,r),e(j[t],n)}}catch(e){}return function(){return!1}}(),S=h.isNode?function(){return process.emit.apply(process,arguments)}:h.global?function(e){var t="on"+e.toLowerCase(),r=h.global[t];return!!r&&(r.apply(h.global,[].slice.call(arguments,1)),!0)}:function(){return!1};function O(e,t){return{promise:t}}var T={promiseCreated:O,promiseFulfilled:O,promiseRejected:O,promiseResolved:O,promiseCancelled:O,promiseChained:function(e,t,r){return{promise:t,child:r}},warning:function(e,t){return{warning:t}},unhandledRejection:function(e,t,r){return{reason:t,promise:r}},rejectionHandled:O},R=function(e){var t=!1;try{t=S.apply(null,arguments)}catch(e){c.throwLater(e),t=!0}var r=!1;try{r=E(e,T[e].apply(null,arguments))}catch(e){c.throwLater(e),r=!0}return r||t};function P(){return!1}function F(e,t,r){var n=this;try{e(t,r,(function(e){if("function"!=typeof e)throw new TypeError("onCancel must be a function, got: "+h.toString(e));n._attachCancellationCallback(e)}))}catch(e){return e}}function A(e){if(!this._isCancellable())return this;var t=this._onCancel();void 0!==t?h.isArray(t)?t.push(e):this._setOnCancel([t,e]):this._setOnCancel(e)}function H(){return this._onCancelField}function q(e){this._onCancelField=e}function D(){this._cancellationParent=void 0,this._onCancelField=void 0}function N(e,t){if(0!=(1&t)){this._cancellationParent=e;var r=e._branchesRemainingToCancel;void 0===r&&(r=0),e._branchesRemainingToCancel=r+1}0!=(2&t)&&e._isBound()&&this._setBoundTo(e._boundTo)}e.config=function(t){if("longStackTraces"in(t=Object(t))&&(t.longStackTraces?e.longStackTraces():!t.longStackTraces&&e.hasLongStackTraces()&&x()),"warnings"in t){var r=t.warnings;te.warnings=!!r,C=te.warnings,h.isObject(r)&&"wForgottenReturn"in r&&(C=!!r.wForgottenReturn)}if("cancellation"in t&&t.cancellation&&!te.cancellation){if(c.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");e.prototype._clearCancellationData=D,e.prototype._propagateFrom=N,e.prototype._onCancel=H,e.prototype._setOnCancel=q,e.prototype._attachCancellationCallback=A,e.prototype._execute=F,L=N,te.cancellation=!0}if("monitoring"in t&&(t.monitoring&&!te.monitoring?(te.monitoring=!0,e.prototype._fireEvent=R):!t.monitoring&&te.monitoring&&(te.monitoring=!1,e.prototype._fireEvent=P)),"asyncHooks"in t&&h.nodeSupportsAsyncResource){var i=te.asyncHooks,s=!!t.asyncHooks;i!==s&&(te.asyncHooks=s,s?n():o())}return e},e.prototype._fireEvent=P,e.prototype._execute=function(e,t,r){try{e(t,r)}catch(e){return e}},e.prototype._onCancel=function(){},e.prototype._setOnCancel=function(e){},e.prototype._attachCancellationCallback=function(e){},e.prototype._captureStackTrace=function(){},e.prototype._attachExtraTrace=function(){},e.prototype._dereferenceTrace=function(){},e.prototype._clearCancellationData=function(){},e.prototype._propagateFrom=function(e,t){};var L=function(e,t){0!=(2&t)&&e._isBound()&&this._setBoundTo(e._boundTo)};function U(){var t=this._boundTo;return void 0!==t&&t instanceof e?t.isFulfilled()?t.value():void 0:t}function M(){this._trace=new Z(this._peekContext())}function I(e,t){if(f(e)){var r=this._trace;if(void 0!==r&&t&&(r=r._parent),void 0!==r)r.attachExtraTrace(e);else if(!e.__stackCleaned__){var n=G(e);h.notEnumerableProp(e,"stack",n.message+"\n"+n.stack.join("\n")),h.notEnumerableProp(e,"__stackCleaned__",!0)}}}function B(){this._trace=void 0}function z(t,r,n){if(te.warnings){var o,i=new l(t);if(r)n._attachExtraTrace(i);else if(te.longStackTraces&&(o=e._peekContext()))o.attachExtraTrace(i);else{var s=G(i);i.stack=s.message+"\n"+s.stack.join("\n")}R("warning",i)||Q(i,"",!0)}}function V(e){for(var t=[],r=0;r<e.length;++r){var n=e[r],o="    (No stack trace)"===n||y.test(n),i=o&&J(n);o&&!i&&(g&&" "!==n.charAt(0)&&(n="    "+n),t.push(n))}return t}function G(e){var t=e.stack,r=e.toString();return t="string"==typeof t&&t.length>0?function(e){for(var t=e.stack.replace(/\s+$/g,"").split("\n"),r=0;r<t.length;++r){var n=t[r];if("    (No stack trace)"===n||y.test(n))break}return r>0&&"SyntaxError"!=e.name&&(t=t.slice(r)),t}(e):["    (No stack trace)"],{message:r,stack:"SyntaxError"==e.name?t:V(t)}}function Q(e,t,r){if("undefined"!=typeof console){var n;if(h.isObject(e)){var o=e.stack;n=t+m(o,e)}else n=t+String(e);"function"==typeof a?a(n,r):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(n)}}function $(e,t,r,n){var o=!1;try{"function"==typeof t&&(o=!0,"rejectionHandled"===e?t(n):t(r,n))}catch(e){c.throwLater(e)}"unhandledRejection"===e?R(e,r,n)||o||Q(r,"Unhandled rejection "):R(e,n)}function W(e){var t;if("function"==typeof e)t="[function "+(e.name||"anonymous")+"]";else{t=e&&"function"==typeof e.toString?e.toString():h.toString(e);if(/\[object [a-zA-Z0-9$_]+\]/.test(t))try{t=JSON.stringify(e)}catch(e){}0===t.length&&(t="(empty array)")}return"(<"+function(e){if(e.length<41)return e;return e.substr(0,38)+"..."}(t)+">, no stack trace)"}function X(){return"function"==typeof ee}var J=function(){return!1},Y=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;function K(e){var t=e.match(Y);if(t)return{fileName:t[1],line:parseInt(t[2],10)}}function Z(e){this._parent=e,this._promisesCreated=0;var t=this._length=1+(void 0===e?0:e._length);ee(this,Z),t>32&&this.uncycle()}h.inherits(Z,Error),t.CapturedTrace=Z,Z.prototype.uncycle=function(){var e=this._length;if(!(e<2)){for(var t=[],r={},n=0,o=this;void 0!==o;++n)t.push(o),o=o._parent;for(n=(e=this._length=n)-1;n>=0;--n){var i=t[n].stack;void 0===r[i]&&(r[i]=n)}for(n=0;n<e;++n){var s=r[t[n].stack];if(void 0!==s&&s!==n){s>0&&(t[s-1]._parent=void 0,t[s-1]._length=1),t[n]._parent=void 0,t[n]._length=1;var a=n>0?t[n-1]:this;s<e-1?(a._parent=t[s+1],a._parent.uncycle(),a._length=a._parent._length+1):(a._parent=void 0,a._length=1);for(var u=a._length+1,c=n-2;c>=0;--c)t[c]._length=u,u++;return}}}},Z.prototype.attachExtraTrace=function(e){if(!e.__stackCleaned__){this.uncycle();for(var t=G(e),r=t.message,n=[t.stack],o=this;void 0!==o;)n.push(V(o.stack.split("\n"))),o=o._parent;!function(e){for(var t=e[0],r=1;r<e.length;++r){for(var n=e[r],o=t.length-1,i=t[o],s=-1,a=n.length-1;a>=0;--a)if(n[a]===i){s=a;break}for(a=s;a>=0;--a){var u=n[a];if(t[o]!==u)break;t.pop(),o--}t=n}}(n),function(e){for(var t=0;t<e.length;++t)(0===e[t].length||t+1<e.length&&e[t][0]===e[t+1][0])&&(e.splice(t,1),t--)}(n),h.notEnumerableProp(e,"stack",function(e,t){for(var r=0;r<t.length-1;++r)t[r].push("From previous event:"),t[r]=t[r].join("\n");return r<t.length&&(t[r]=t[r].join("\n")),e+"\n"+t.join("\n")}(r,n)),h.notEnumerableProp(e,"__stackCleaned__",!0)}};var ee=function(){var e=/^\s*at\s*/,t=function(e,t){return"string"==typeof e?e:void 0!==t.name&&void 0!==t.message?t.toString():W(t)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,y=e,m=t;var r=Error.captureStackTrace;return J=function(e){return d.test(e)},function(e,t){Error.stackTraceLimit+=6,r(e,t),Error.stackTraceLimit-=6}}var n,o=new Error;if("string"==typeof o.stack&&o.stack.split("\n")[0].indexOf("stackDetection@")>=0)return y=/@/,m=t,g=!0,function(e){e.stack=(new Error).stack};try{throw new Error}catch(e){n="stack"in e}return"stack"in o||!n||"number"!=typeof Error.stackTraceLimit?(m=function(e,t){return"string"==typeof e?e:"object"!=typeof t&&"function"!=typeof t||void 0===t.name||void 0===t.message?W(t):t.toString()},null):(y=e,m=t,function(e){Error.stackTraceLimit+=6;try{throw new Error}catch(t){e.stack=t.stack}Error.stackTraceLimit-=6})}();"undefined"!=typeof console&&void 0!==console.warn&&(a=function(e){console.warn(e)},h.isNode&&process.stderr.isTTY?a=function(e,t){var r=t?"[33m":"[31m";console.warn(r+e+"[0m\n")}:h.isNode||"string"!=typeof(new Error).stack||(a=function(e,t){console.warn("%c"+e,t?"color: darkorange":"color: red")}));var te={warnings:w,longStackTraces:!1,cancellation:!1,monitoring:!1,asyncHooks:!1};return k&&e.longStackTraces(),{asyncHooks:function(){return te.asyncHooks},longStackTraces:function(){return te.longStackTraces},warnings:function(){return te.warnings},cancellation:function(){return te.cancellation},monitoring:function(){return te.monitoring},propagateFromFunction:function(){return L},boundValueFunction:function(){return U},checkForgottenReturns:function(e,t,r,n,o){if(void 0===e&&null!==t&&C){if(void 0!==o&&o._returnedNonUndefined())return;if(0==(65535&n._bitField))return;r&&(r+=" ");var i="",s="";if(t._trace){for(var a=t._trace.stack.split("\n"),u=V(a),c=u.length-1;c>=0;--c){var l=u[c];if(!_.test(l)){var h=l.match(v);h&&(i="at "+h[1]+":"+h[2]+":"+h[3]+" ");break}}if(u.length>0){var p=u[0];for(c=0;c<a.length;++c)if(a[c]===p){c>0&&(s="\n"+a[c-1]);break}}}var f="a promise was created in a "+r+"handler "+i+"but was not returned from it, see http://goo.gl/rRqMUw"+s;n._warn(f,!0,t)}},setBounds:function(e,t){if(X()){for(var r,n,o=(e.stack||"").split("\n"),i=(t.stack||"").split("\n"),s=-1,a=-1,u=0;u<o.length;++u){if(c=K(o[u])){r=c.fileName,s=c.line;break}}for(u=0;u<i.length;++u){var c;if(c=K(i[u])){n=c.fileName,a=c.line;break}}s<0||a<0||!r||!n||r!==n||s>=a||(J=function(e){if(d.test(e))return!0;var t=K(e);return!!(t&&t.fileName===r&&s<=t.line&&t.line<=a)})}},warn:z,deprecated:function(e,t){var r=e+" is deprecated and will be removed in a future version.";return t&&(r+=" Use "+t+" instead."),z(r)},CapturedTrace:Z,fireDomEvent:E,fireGlobalEvent:S}}},function(e,t,r){"use strict";e.exports=function(e,t,n){var o=r(0),i=e.CancellationError,s=o.errorObj,a=r(15)(n);function u(e,t,r){this.promise=e,this.type=t,this.handler=r,this.called=!1,this.cancelPromise=null}function c(e){this.finallyHandler=e}function l(e,t){return null!=e.cancelPromise&&(arguments.length>1?e.cancelPromise._reject(t):e.cancelPromise._cancel(),e.cancelPromise=null,!0)}function h(){return f.call(this,this.promise._target()._settledValue())}function p(e){if(!l(this,e))return s.e=e,s}function f(r){var o=this.promise,a=this.handler;if(!this.called){this.called=!0;var u=this.isFinallyHandler()?a.call(o._boundValue()):a.call(o._boundValue(),r);if(u===n)return u;if(void 0!==u){o._setReturnedNonUndefined();var f=t(u,o);if(f instanceof e){if(null!=this.cancelPromise){if(f._isCancelled()){var d=new i("late cancellation observer");return o._attachExtraTrace(d),s.e=d,s}f.isPending()&&f._attachCancellationCallback(new c(this))}return f._then(h,p,void 0,this,void 0)}}}return o.isRejected()?(l(this),s.e=r,s):(l(this),r)}return u.prototype.isFinallyHandler=function(){return 0===this.type},c.prototype._resultCancelled=function(){l(this.finallyHandler)},e.prototype._passThrough=function(e,t,r,n){return"function"!=typeof e?this.then():this._then(r,n,void 0,new u(this,t,e),void 0)},e.prototype.lastly=e.prototype.finally=function(e){return this._passThrough(e,0,f,f)},e.prototype.tap=function(e){return this._passThrough(e,1,f)},e.prototype.tapCatch=function(t){var r=arguments.length;if(1===r)return this._passThrough(t,1,void 0,f);var n,i=new Array(r-1),s=0;for(n=0;n<r-1;++n){var u=arguments[n];if(!o.isObject(u))return e.reject(new TypeError("tapCatch statement predicate: expecting an object but got "+o.classString(u)));i[s++]=u}i.length=s;var c=arguments[n];return this._passThrough(a(i,c,this),1,void 0,f)},u}},function(e,t,r){"use strict";e.exports=function(e,t,n,o,i){var s=r(0),a=s.tryCatch;e.method=function(r){if("function"!=typeof r)throw new e.TypeError("expecting a function but got "+s.classString(r));return function(){var n=new e(t);n._captureStackTrace(),n._pushContext();var o=a(r).apply(this,arguments),s=n._popContext();return i.checkForgottenReturns(o,s,"Promise.method",n),n._resolveFromSyncValue(o),n}},e.attempt=e.try=function(r){if("function"!=typeof r)return o("expecting a function but got "+s.classString(r));var n,u=new e(t);if(u._captureStackTrace(),u._pushContext(),arguments.length>1){i.deprecated("calling Promise.try with more than 1 argument");var c=arguments[1],l=arguments[2];n=s.isArray(c)?a(r).apply(l,c):a(r).call(l,c)}else n=a(r)();var h=u._popContext();return i.checkForgottenReturns(n,h,"Promise.try",u),u._resolveFromSyncValue(n),u},e.prototype._resolveFromSyncValue=function(e){e===s.errorObj?this._rejectCallback(e.e,!1):this._resolveCallback(e,!0)}}},function(e,t,r){"use strict";e.exports=function(e,t,r,n){var o=!1,i=function(e,t){this._reject(t)},s=function(e,t){t.promiseRejectionQueued=!0,t.bindingPromise._then(i,i,null,this,e)},a=function(e,t){0==(50397184&this._bitField)&&this._resolveCallback(t.target)},u=function(e,t){t.promiseRejectionQueued||this._reject(e)};e.prototype.bind=function(i){o||(o=!0,e.prototype._propagateFrom=n.propagateFromFunction(),e.prototype._boundValue=n.boundValueFunction());var c=r(i),l=new e(t);l._propagateFrom(this,1);var h=this._target();if(l._setBoundTo(c),c instanceof e){var p={promiseRejectionQueued:!1,promise:l,target:h,bindingPromise:c};h._then(t,s,void 0,l,p),c._then(a,u,void 0,l,p),l._setOnCancel(c)}else l._resolveCallback(h);return l},e.prototype._setBoundTo=function(e){void 0!==e?(this._bitField=2097152|this._bitField,this._boundTo=e):this._bitField=-2097153&this._bitField},e.prototype._isBound=function(){return 2097152==(2097152&this._bitField)},e.bind=function(t,r){return e.resolve(r).bind(t)}}},function(e,t,r){"use strict";e.exports=function(e,t,n,o){var i=r(0),s=i.tryCatch,a=i.errorObj,u=e._async;e.prototype.break=e.prototype.cancel=function(){if(!o.cancellation())return this._warn("cancellation is disabled");for(var e=this,t=e;e._isCancellable();){if(!e._cancelBy(t)){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}var r=e._cancellationParent;if(null==r||!r._isCancellable()){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}e._isFollowing()&&e._followee().cancel(),e._setWillBeCancelled(),t=e,e=r}},e.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},e.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},e.prototype._cancelBy=function(e){return e===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},e.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},e.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),u.invoke(this._cancelPromises,this,void 0))},e.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},e.prototype._unsetOnCancel=function(){this._onCancelField=void 0},e.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},e.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},e.prototype._doInvokeOnCancel=function(e,t){if(i.isArray(e))for(var r=0;r<e.length;++r)this._doInvokeOnCancel(e[r],t);else if(void 0!==e)if("function"==typeof e){if(!t){var n=s(e).call(this._boundValue());n===a&&(this._attachExtraTrace(n.e),u.throwLater(n.e))}}else e._resultCancelled(this)},e.prototype._invokeOnCancel=function(){var e=this._onCancel();this._unsetOnCancel(),u.invoke(this._doInvokeOnCancel,this,e)},e.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},e.prototype._resultCancelled=function(){this.cancel()}}},function(e,t,r){"use strict";e.exports=function(e){function t(){return this.value}function r(){throw this.reason}e.prototype.return=e.prototype.thenReturn=function(r){return r instanceof e&&r.suppressUnhandledRejections(),this._then(t,void 0,void 0,{value:r},void 0)},e.prototype.throw=e.prototype.thenThrow=function(e){return this._then(r,void 0,void 0,{reason:e},void 0)},e.prototype.catchThrow=function(e){if(arguments.length<=1)return this._then(void 0,r,void 0,{reason:e},void 0);var t=arguments[1],n=function(){throw t};return this.caught(e,n)},e.prototype.catchReturn=function(r){if(arguments.length<=1)return r instanceof e&&r.suppressUnhandledRejections(),this._then(void 0,t,void 0,{value:r},void 0);var n=arguments[1];n instanceof e&&n.suppressUnhandledRejections();var o=function(){return n};return this.caught(r,o)}}},function(e,t,r){"use strict";e.exports=function(e){function t(e){void 0!==e?(e=e._target(),this._bitField=e._bitField,this._settledValueField=e._isFateSealed()?e._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}t.prototype._settledValue=function(){return this._settledValueField};var r=t.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},n=t.prototype.error=t.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},o=t.prototype.isFulfilled=function(){return 0!=(33554432&this._bitField)},i=t.prototype.isRejected=function(){return 0!=(16777216&this._bitField)},s=t.prototype.isPending=function(){return 0==(50397184&this._bitField)},a=t.prototype.isResolved=function(){return 0!=(50331648&this._bitField)};t.prototype.isCancelled=function(){return 0!=(8454144&this._bitField)},e.prototype.__isCancelled=function(){return 65536==(65536&this._bitField)},e.prototype._isCancelled=function(){return this._target().__isCancelled()},e.prototype.isCancelled=function(){return 0!=(8454144&this._target()._bitField)},e.prototype.isPending=function(){return s.call(this._target())},e.prototype.isRejected=function(){return i.call(this._target())},e.prototype.isFulfilled=function(){return o.call(this._target())},e.prototype.isResolved=function(){return a.call(this._target())},e.prototype.value=function(){return r.call(this._target())},e.prototype.reason=function(){var e=this._target();return e._unsetRejectionIsUnhandled(),n.call(e)},e.prototype._value=function(){return this._settledValue()},e.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},e.PromiseInspection=t}},function(e,t,r){"use strict";e.exports=function(e,t,n,o,i){var s,a=r(0),u=a.canEvaluate,c=a.tryCatch,l=a.errorObj;if(u){for(var h=function(e){return new Function("value","holder","                             \n            'use strict';                                                    \n            holder.pIndex = value;                                           \n            holder.checkFulfillment(this);                                   \n            ".replace(/Index/g,e))},p=function(e){return new Function("promise","holder","                           \n            'use strict';                                                    \n            holder.pIndex = promise;                                         \n            ".replace(/Index/g,e))},f=function(t){for(var r=new Array(t),n=0;n<r.length;++n)r[n]="this.p"+(n+1);var o=r.join(" = ")+" = null;",s="var promise;\n"+r.map((function(e){return"                                                         \n                promise = "+e+";                                      \n                if (promise instanceof Promise) {                            \n                    promise.cancel();                                        \n                }                                                            \n            "})).join("\n"),a=r.join(", "),u="Holder$"+t,h="return function(tryCatch, errorObj, Promise, async) {    \n            'use strict';                                                    \n            function [TheName](fn) {                                         \n                [TheProperties]                                              \n                this.fn = fn;                                                \n                this.asyncNeeded = true;                                     \n                this.now = 0;                                                \n            }                                                                \n                                                                             \n            [TheName].prototype._callFunction = function(promise) {          \n                promise._pushContext();                                      \n                var ret = tryCatch(this.fn)([ThePassedArguments]);           \n                promise._popContext();                                       \n                if (ret === errorObj) {                                      \n                    promise._rejectCallback(ret.e, false);                   \n                } else {                                                     \n                    promise._resolveCallback(ret);                           \n                }                                                            \n            };                                                               \n                                                                             \n            [TheName].prototype.checkFulfillment = function(promise) {       \n                var now = ++this.now;                                        \n                if (now === [TheTotal]) {                                    \n                    if (this.asyncNeeded) {                                  \n                        async.invoke(this._callFunction, this, promise);     \n                    } else {                                                 \n                        this._callFunction(promise);                         \n                    }                                                        \n                                                                             \n                }                                                            \n            };                                                               \n                                                                             \n            [TheName].prototype._resultCancelled = function() {              \n                [CancellationCode]                                           \n            };                                                               \n                                                                             \n            return [TheName];                                                \n        }(tryCatch, errorObj, Promise, async);                               \n        ";return h=h.replace(/\[TheName\]/g,u).replace(/\[TheTotal\]/g,t).replace(/\[ThePassedArguments\]/g,a).replace(/\[TheProperties\]/g,o).replace(/\[CancellationCode\]/g,s),new Function("tryCatch","errorObj","Promise","async",h)(c,l,e,i)},d=[],_=[],v=[],y=0;y<8;++y)d.push(f(y+1)),_.push(h(y+1)),v.push(p(y+1));s=function(e){this._reject(e)}}e.join=function(){var r,i=arguments.length-1;if(i>0&&"function"==typeof arguments[i]&&(r=arguments[i],i<=8&&u)){(k=new e(o))._captureStackTrace();for(var c=d[i-1],l=new c(r),h=_,p=0;p<i;++p){var f=n(arguments[p],k);if(f instanceof e){var y=(f=f._target())._bitField;0==(50397184&y)?(f._then(h[p],s,void 0,k,l),v[p](f,l),l.asyncNeeded=!1):0!=(33554432&y)?h[p].call(k,f._value(),l):0!=(16777216&y)?k._reject(f._reason()):k._cancel()}else h[p].call(k,f,l)}if(!k._isFateSealed()){if(l.asyncNeeded){var m=e._getContext();l.fn=a.contextBind(m,l.fn)}k._setAsyncGuaranteed(),k._setOnCancel(l)}return k}for(var g=arguments.length,b=new Array(g),w=0;w<g;++w)b[w]=arguments[w];r&&b.pop();var k=new t(b).promise();return void 0!==r?k.spread(r):k}}},function(e,t,r){"use strict";var n=Object.create;if(n){var o=n(null),i=n(null);o[" size"]=i[" size"]=0}e.exports=function(e){var t,n,s=r(0),a=s.canEvaluate,u=s.isIdentifier,c=function(e){return new Function("ensureMethod","                                    \n        return function(obj) {                                               \n            'use strict'                                                     \n            var len = this.length;                                           \n            ensureMethod(obj, 'methodName');                                 \n            switch(len) {                                                    \n                case 1: return obj.methodName(this[0]);                      \n                case 2: return obj.methodName(this[0], this[1]);             \n                case 3: return obj.methodName(this[0], this[1], this[2]);    \n                case 0: return obj.methodName();                             \n                default:                                                     \n                    return obj.methodName.apply(obj, this);                  \n            }                                                                \n        };                                                                   \n        ".replace(/methodName/g,e))(p)},l=function(e){return new Function("obj","                                             \n        'use strict';                                                        \n        return obj.propertyName;                                             \n        ".replace("propertyName",e))},h=function(e,t,r){var n=r[e];if("function"!=typeof n){if(!u(e))return null;if(n=t(e),r[e]=n,r[" size"]++,r[" size"]>512){for(var o=Object.keys(r),i=0;i<256;++i)delete r[o[i]];r[" size"]=o.length-256}}return n};function p(t,r){var n;if(null!=t&&(n=t[r]),"function"!=typeof n){var o="Object "+s.classString(t)+" has no method '"+s.toString(r)+"'";throw new e.TypeError(o)}return n}function f(e){return p(e,this.pop()).apply(e,this)}function d(e){return e[this]}function _(e){var t=+this;return t<0&&(t=Math.max(0,t+e.length)),e[t]}t=function(e){return h(e,c,o)},n=function(e){return h(e,l,i)},e.prototype.call=function(e){for(var r=arguments.length,n=new Array(Math.max(r-1,0)),o=1;o<r;++o)n[o-1]=arguments[o];if(a){var i=t(e);if(null!==i)return this._then(i,void 0,void 0,n,void 0)}return n.push(e),this._then(f,void 0,void 0,n,void 0)},e.prototype.get=function(e){var t;if("number"==typeof e)t=_;else if(a){var r=n(e);t=null!==r?r:d}else t=d;return this._then(t,void 0,void 0,e,void 0)}}},function(e,t,r){"use strict";e.exports=function(e,t,n,o,i,s){var a=r(1).TypeError,u=r(0),c=u.errorObj,l=u.tryCatch,h=[];function p(t,r,o,i){if(s.cancellation()){var a=new e(n),u=this._finallyPromise=new e(n);this._promise=a.lastly((function(){return u})),a._captureStackTrace(),a._setOnCancel(this)}else{(this._promise=new e(n))._captureStackTrace()}this._stack=i,this._generatorFunction=t,this._receiver=r,this._generator=void 0,this._yieldHandlers="function"==typeof o?[o].concat(h):h,this._yieldedPromise=null,this._cancellationPhase=!1}u.inherits(p,i),p.prototype._isResolved=function(){return null===this._promise},p.prototype._cleanup=function(){this._promise=this._generator=null,s.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},p.prototype._promiseCancelled=function(){if(!this._isResolved()){var t;if(void 0!==this._generator.return)this._promise._pushContext(),t=l(this._generator.return).call(this._generator,void 0),this._promise._popContext();else{var r=new e.CancellationError("generator .return() sentinel");e.coroutine.returnSentinel=r,this._promise._attachExtraTrace(r),this._promise._pushContext(),t=l(this._generator.throw).call(this._generator,r),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(t)}},p.prototype._promiseFulfilled=function(e){this._yieldedPromise=null,this._promise._pushContext();var t=l(this._generator.next).call(this._generator,e);this._promise._popContext(),this._continue(t)},p.prototype._promiseRejected=function(e){this._yieldedPromise=null,this._promise._attachExtraTrace(e),this._promise._pushContext();var t=l(this._generator.throw).call(this._generator,e);this._promise._popContext(),this._continue(t)},p.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof e){var t=this._yieldedPromise;this._yieldedPromise=null,t.cancel()}},p.prototype.promise=function(){return this._promise},p.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},p.prototype._continue=function(t){var r=this._promise;if(t===c)return this._cleanup(),this._cancellationPhase?r.cancel():r._rejectCallback(t.e,!1);var n=t.value;if(!0===t.done)return this._cleanup(),this._cancellationPhase?r.cancel():r._resolveCallback(n);var i=o(n,this._promise);if(i instanceof e||null!==(i=function(t,r,n){for(var i=0;i<r.length;++i){n._pushContext();var s=l(r[i])(t);if(n._popContext(),s===c){n._pushContext();var a=e.reject(c.e);return n._popContext(),a}var u=o(s,n);if(u instanceof e)return u}return null}(i,this._yieldHandlers,this._promise))){var s=(i=i._target())._bitField;0==(50397184&s)?(this._yieldedPromise=i,i._proxy(this,null)):0!=(33554432&s)?e._async.invoke(this._promiseFulfilled,this,i._value()):0!=(16777216&s)?e._async.invoke(this._promiseRejected,this,i._reason()):this._promiseCancelled()}else this._promiseRejected(new a("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",String(n))+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")))},e.coroutine=function(e,t){if("function"!=typeof e)throw new a("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var r=Object(t).yieldHandler,n=p,o=(new Error).stack;return function(){var t=e.apply(this,arguments),i=new n(void 0,void 0,r,o),s=i.promise();return i._generator=t,i._promiseFulfilled(void 0),s}},e.coroutine.addYieldHandler=function(e){if("function"!=typeof e)throw new a("expecting a function but got "+u.classString(e));h.push(e)},e.spawn=function(r){if(s.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof r)return t("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var n=new p(r,this),o=n.promise();return n._run(e.spawn),o}}},function(e,t,r){"use strict";e.exports=function(e,t,n,o,i,s){var a=r(0),u=a.tryCatch,c=a.errorObj,l=e._async;function h(t,r,n,o){this.constructor$(t),this._promise._captureStackTrace();var s=e._getContext();if(this._callback=a.contextBind(s,r),this._preservedValues=o===i?new Array(this.length()):null,this._limit=n,this._inFlight=0,this._queue=[],l.invoke(this._asyncInit,this,void 0),a.isArray(t))for(var u=0;u<t.length;++u){var c=t[u];c instanceof e&&c.suppressUnhandledRejections()}}function p(t,r,o,i){if("function"!=typeof r)return n("expecting a function but got "+a.classString(r));var s=0;if(void 0!==o){if("object"!=typeof o||null===o)return e.reject(new TypeError("options argument must be an object but it is "+a.classString(o)));if("number"!=typeof o.concurrency)return e.reject(new TypeError("'concurrency' must be a number but it is "+a.classString(o.concurrency)));s=o.concurrency}return new h(t,r,s="number"==typeof s&&isFinite(s)&&s>=1?s:0,i).promise()}a.inherits(h,t),h.prototype._asyncInit=function(){this._init$(void 0,-2)},h.prototype._init=function(){},h.prototype._promiseFulfilled=function(t,r){var n=this._values,i=this.length(),a=this._preservedValues,l=this._limit;if(r<0){if(n[r=-1*r-1]=t,l>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(l>=1&&this._inFlight>=l)return n[r]=t,this._queue.push(r),!1;null!==a&&(a[r]=t);var h=this._promise,p=this._callback,f=h._boundValue();h._pushContext();var d=u(p).call(f,t,r,i),_=h._popContext();if(s.checkForgottenReturns(d,_,null!==a?"Promise.filter":"Promise.map",h),d===c)return this._reject(d.e),!0;var v=o(d,this._promise);if(v instanceof e){var y=(v=v._target())._bitField;if(0==(50397184&y))return l>=1&&this._inFlight++,n[r]=v,v._proxy(this,-1*(r+1)),!1;if(0==(33554432&y))return 0!=(16777216&y)?(this._reject(v._reason()),!0):(this._cancel(),!0);d=v._value()}n[r]=d}return++this._totalResolved>=i&&(null!==a?this._filter(n,a):this._resolve(n),!0)},h.prototype._drainQueue=function(){for(var e=this._queue,t=this._limit,r=this._values;e.length>0&&this._inFlight<t;){if(this._isResolved())return;var n=e.pop();this._promiseFulfilled(r[n],n)}},h.prototype._filter=function(e,t){for(var r=t.length,n=new Array(r),o=0,i=0;i<r;++i)e[i]&&(n[o++]=t[i]);n.length=o,this._resolve(n)},h.prototype.preservedValues=function(){return this._preservedValues},e.prototype.map=function(e,t){return p(this,e,t,null)},e.map=function(e,t,r,n){return p(e,t,r,n)}}},function(e,t,r){"use strict";e.exports=function(e){var t=r(0),n=e._async,o=t.tryCatch,i=t.errorObj;function s(e,r){if(!t.isArray(e))return a.call(this,e,r);var s=o(r).apply(this._boundValue(),[null].concat(e));s===i&&n.throwLater(s.e)}function a(e,t){var r=this._boundValue(),s=void 0===e?o(t).call(r,null):o(t).call(r,null,e);s===i&&n.throwLater(s.e)}function u(e,t){if(!e){var r=new Error(e+"");r.cause=e,e=r}var s=o(t).call(this._boundValue(),e);s===i&&n.throwLater(s.e)}e.prototype.asCallback=e.prototype.nodeify=function(e,t){if("function"==typeof e){var r=a;void 0!==t&&Object(t).spread&&(r=s),this._then(r,u,void 0,this,e)}return this}}},function(e,t,r){"use strict";e.exports=function(e,t){var n={},o=r(0),i=r(16),s=o.withAppended,a=o.maybeWrapAsError,u=o.canEvaluate,c=r(1).TypeError,l={__isPromisified__:!0},h=new RegExp("^(?:"+["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"].join("|")+")$"),p=function(e){return o.isIdentifier(e)&&"_"!==e.charAt(0)&&"constructor"!==e};function f(e){return!h.test(e)}function d(e){try{return!0===e.__isPromisified__}catch(e){return!1}}function _(e,t,r){var n=o.getDataPropertyOrDefault(e,t+r,l);return!!n&&d(n)}function v(e,t,r,n){for(var i=o.inheritedDataKeys(e),s=[],a=0;a<i.length;++a){var u=i[a],l=e[u],h=n===p||p(u);"function"!=typeof l||d(l)||_(e,u,t)||!n(u,l,e,h)||s.push(u,l)}return function(e,t,r){for(var n=0;n<e.length;n+=2){var o=e[n];if(r.test(o))for(var i=o.replace(r,""),s=0;s<e.length;s+=2)if(e[s]===i)throw new c("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",t))}}(s,t,r),s}var y=u?function(r,u,c,l,h,p){var f=Math.max(0,function(e){return"number"==typeof e.length?Math.max(Math.min(e.length,1024),0):0}(l)-1),d=function(e){for(var t=[e],r=Math.max(0,e-1-3),n=e-1;n>=r;--n)t.push(n);for(n=e+1;n<=3;++n)t.push(n);return t}(f),_="string"==typeof r||u===n;function v(e){var t,r=(t=e,o.filledRange(t,"_arg","")).join(", "),n=e>0?", ":"";return(_?"ret = callback.call(this, {{args}}, nodeback); break;\n":void 0===u?"ret = callback({{args}}, nodeback); break;\n":"ret = callback.call(receiver, {{args}}, nodeback); break;\n").replace("{{args}}",r).replace(", ",n)}var y="string"==typeof r?"this != null ? this['"+r+"'] : fn":"fn",m="'use strict';                                                \n        var ret = function (Parameters) {                                    \n            'use strict';                                                    \n            var len = arguments.length;                                      \n            var promise = new Promise(INTERNAL);                             \n            promise._captureStackTrace();                                    \n            var nodeback = nodebackForPromise(promise, "+p+");   \n            var ret;                                                         \n            var callback = tryCatch([GetFunctionCode]);                      \n            switch(len) {                                                    \n                [CodeForSwitchCase]                                          \n            }                                                                \n            if (ret === errorObj) {                                          \n                promise._rejectCallback(maybeWrapAsError(ret.e), true, true);\n            }                                                                \n            if (!promise._isFateSealed()) promise._setAsyncGuaranteed();     \n            return promise;                                                  \n        };                                                                   \n        notEnumerableProp(ret, '__isPromisified__', true);                   \n        return ret;                                                          \n    ".replace("[CodeForSwitchCase]",function(){for(var e="",t=0;t<d.length;++t)e+="case "+d[t]+":"+v(d[t]);return e+="                                                             \n        default:                                                             \n            var args = new Array(len + 1);                                   \n            var i = 0;                                                       \n            for (var i = 0; i < len; ++i) {                                  \n               args[i] = arguments[i];                                       \n            }                                                                \n            args[i] = nodeback;                                              \n            [CodeForCall]                                                    \n            break;                                                           \n        ".replace("[CodeForCall]",_?"ret = callback.apply(this, args);\n":"ret = callback.apply(receiver, args);\n")}()).replace("[GetFunctionCode]",y);return m=m.replace("Parameters",function(e){return o.filledRange(Math.max(e,3),"_arg","")}(f)),new Function("Promise","fn","receiver","withAppended","maybeWrapAsError","nodebackForPromise","tryCatch","errorObj","notEnumerableProp","INTERNAL",m)(e,l,u,s,a,i,o.tryCatch,o.errorObj,o.notEnumerableProp,t)}:function(r,u,c,l,h,p){var f=function(){return this}(),d=r;function _(){var o=u;u===n&&(o=this);var c=new e(t);c._captureStackTrace();var l="string"==typeof d&&this!==f?this[d]:r,h=i(c,p);try{l.apply(o,s(arguments,h))}catch(e){c._rejectCallback(a(e),!0,!0)}return c._isFateSealed()||c._setAsyncGuaranteed(),c}return"string"==typeof d&&(r=l),o.notEnumerableProp(_,"__isPromisified__",!0),_};function m(e,t,r,i,s){for(var a=new RegExp(t.replace(/([$])/,"\\$")+"$"),u=v(e,t,a,r),c=0,l=u.length;c<l;c+=2){var h=u[c],p=u[c+1],f=h+t;if(i===y)e[f]=y(h,n,h,p,t,s);else{var d=i(p,(function(){return y(h,n,h,p,t,s)}));o.notEnumerableProp(d,"__isPromisified__",!0),e[f]=d}}return o.toFastProperties(e),e}e.promisify=function(e,t){if("function"!=typeof e)throw new c("expecting a function but got "+o.classString(e));if(d(e))return e;var r=function(e,t,r){return y(e,t,void 0,e,null,r)}(e,void 0===(t=Object(t)).context?n:t.context,!!t.multiArgs);return o.copyDescriptors(e,r,f),r},e.promisifyAll=function(e,t){if("function"!=typeof e&&"object"!=typeof e)throw new c("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");var r=!!(t=Object(t)).multiArgs,n=t.suffix;"string"!=typeof n&&(n="Async");var i=t.filter;"function"!=typeof i&&(i=p);var s=t.promisifier;if("function"!=typeof s&&(s=y),!o.isIdentifier(n))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var a=o.inheritedDataKeys(e),u=0;u<a.length;++u){var l=e[a[u]];"constructor"!==a[u]&&o.isClass(l)&&(m(l.prototype,n,i,s,r),m(l,n,i,s,r))}return m(e,n,i,s,r)}}},function(e,t,r){"use strict";e.exports=function(e,t,n,o){var i,s=r(0),a=s.isObject,u=r(2);"function"==typeof Map&&(i=Map);var c=function(){var e=0,t=0;function r(r,n){this[e]=r,this[e+t]=n,e++}return function(n){t=n.size,e=0;var o=new Array(2*n.size);return n.forEach(r,o),o}}();function l(e){var t,r=!1;if(void 0!==i&&e instanceof i)t=c(e),r=!0;else{var n=u.keys(e),o=n.length;t=new Array(2*o);for(var s=0;s<o;++s){var a=n[s];t[s]=e[a],t[s+o]=a}}this.constructor$(t),this._isMap=r,this._init$(void 0,r?-6:-3)}function h(t){var r,i=n(t);return a(i)?(r=i instanceof e?i._then(e.props,void 0,void 0,void 0,void 0):new l(i).promise(),i instanceof e&&r._propagateFrom(i,2),r):o("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}s.inherits(l,t),l.prototype._init=function(){},l.prototype._promiseFulfilled=function(e,t){if(this._values[t]=e,++this._totalResolved>=this._length){var r;if(this._isMap)r=function(e){for(var t=new i,r=e.length/2|0,n=0;n<r;++n){var o=e[r+n],s=e[n];t.set(o,s)}return t}(this._values);else{r={};for(var n=this.length(),o=0,s=this.length();o<s;++o)r[this._values[o+n]]=this._values[o]}return this._resolve(r),!0}return!1},l.prototype.shouldCopyValues=function(){return!1},l.prototype.getActualLength=function(e){return e>>1},e.prototype.props=function(){return h(this)},e.props=function(e){return h(e)}}},function(e,t,r){"use strict";e.exports=function(e,t,n,o){var i=r(0);function s(r,a){var u,c=n(r);if(c instanceof e)return(u=c).then((function(e){return s(e,u)}));if(null===(r=i.asArray(r)))return o("expecting an array or an iterable object but got "+i.classString(r));var l=new e(t);void 0!==a&&l._propagateFrom(a,3);for(var h=l._fulfill,p=l._reject,f=0,d=r.length;f<d;++f){var _=r[f];(void 0!==_||f in r)&&e.cast(_)._then(h,p,void 0,l,null)}return l}e.race=function(e){return s(e,void 0)},e.prototype.race=function(){return s(this,void 0)}}},function(e,t,r){"use strict";e.exports=function(e,t,n,o,i,s){var a=r(0),u=a.tryCatch;function c(t,r,n,o){this.constructor$(t);var s=e._getContext();this._fn=a.contextBind(s,r),void 0!==n&&(n=e.resolve(n))._attachCancellationCallback(this),this._initialValue=n,this._currentCancellable=null,this._eachValues=o===i?Array(this._length):0===o?null:void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function l(e,t){this.isFulfilled()?t._resolve(e):t._reject(e)}function h(e,t,r,o){return"function"!=typeof t?n("expecting a function but got "+a.classString(t)):new c(e,t,r,o).promise()}function p(t){this.accum=t,this.array._gotAccum(t);var r=o(this.value,this.array._promise);return r instanceof e?(this.array._currentCancellable=r,r._then(f,void 0,void 0,this,void 0)):f.call(this,r)}function f(t){var r,n=this.array,o=n._promise,i=u(n._fn);o._pushContext(),(r=void 0!==n._eachValues?i.call(o._boundValue(),t,this.index,this.length):i.call(o._boundValue(),this.accum,t,this.index,this.length))instanceof e&&(n._currentCancellable=r);var a=o._popContext();return s.checkForgottenReturns(r,a,void 0!==n._eachValues?"Promise.each":"Promise.reduce",o),r}a.inherits(c,t),c.prototype._gotAccum=function(e){void 0!==this._eachValues&&null!==this._eachValues&&e!==i&&this._eachValues.push(e)},c.prototype._eachComplete=function(e){return null!==this._eachValues&&this._eachValues.push(e),this._eachValues},c.prototype._init=function(){},c.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},c.prototype.shouldCopyValues=function(){return!1},c.prototype._resolve=function(e){this._promise._resolveCallback(e),this._values=null},c.prototype._resultCancelled=function(t){if(t===this._initialValue)return this._cancel();this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof e&&this._currentCancellable.cancel(),this._initialValue instanceof e&&this._initialValue.cancel())},c.prototype._iterate=function(t){var r,n;this._values=t;var o=t.length;void 0!==this._initialValue?(r=this._initialValue,n=0):(r=e.resolve(t[0]),n=1),this._currentCancellable=r;for(var i=n;i<o;++i){var s=t[i];s instanceof e&&s.suppressUnhandledRejections()}if(!r.isRejected())for(;n<o;++n){var a={accum:null,value:t[n],index:n,length:o,array:this};r=r._then(p,void 0,void 0,a,void 0),0==(127&n)&&r._setNoAsyncGuarantee()}void 0!==this._eachValues&&(r=r._then(this._eachComplete,void 0,void 0,this,void 0)),r._then(l,l,void 0,r,this)},e.prototype.reduce=function(e,t){return h(this,e,t,null)},e.reduce=function(e,t,r,n){return h(e,t,r,n)}}},function(e,t,r){"use strict";e.exports=function(e,t,n){var o=e.PromiseInspection;function i(e){this.constructor$(e)}r(0).inherits(i,t),i.prototype._promiseResolved=function(e,t){return this._values[e]=t,++this._totalResolved>=this._length&&(this._resolve(this._values),!0)},i.prototype._promiseFulfilled=function(e,t){var r=new o;return r._bitField=33554432,r._settledValueField=e,this._promiseResolved(t,r)},i.prototype._promiseRejected=function(e,t){var r=new o;return r._bitField=16777216,r._settledValueField=e,this._promiseResolved(t,r)},e.settle=function(e){return n.deprecated(".settle()",".reflect()"),new i(e).promise()},e.allSettled=function(e){return new i(e).promise()},e.prototype.settle=function(){return e.settle(this)}}},function(e,t,r){"use strict";e.exports=function(e,t,n){var o=r(0),i=r(1).RangeError,s=r(1).AggregateError,a=o.isArray,u={};function c(e){this.constructor$(e),this._howMany=0,this._unwrap=!1,this._initialized=!1}function l(e,t){if((0|t)!==t||t<0)return n("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var r=new c(e),o=r.promise();return r.setHowMany(t),r.init(),o}o.inherits(c,t),c.prototype._init=function(){if(this._initialized)if(0!==this._howMany){this._init$(void 0,-5);var e=a(this._values);!this._isResolved()&&e&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}else this._resolve([])},c.prototype.init=function(){this._initialized=!0,this._init()},c.prototype.setUnwrap=function(){this._unwrap=!0},c.prototype.howMany=function(){return this._howMany},c.prototype.setHowMany=function(e){this._howMany=e},c.prototype._promiseFulfilled=function(e){return this._addFulfilled(e),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},c.prototype._promiseRejected=function(e){return this._addRejected(e),this._checkOutcome()},c.prototype._promiseCancelled=function(){return this._values instanceof e||null==this._values?this._cancel():(this._addRejected(u),this._checkOutcome())},c.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var e=new s,t=this.length();t<this._values.length;++t)this._values[t]!==u&&e.push(this._values[t]);return e.length>0?this._reject(e):this._cancel(),!0}return!1},c.prototype._fulfilled=function(){return this._totalResolved},c.prototype._rejected=function(){return this._values.length-this.length()},c.prototype._addRejected=function(e){this._values.push(e)},c.prototype._addFulfilled=function(e){this._values[this._totalResolved++]=e},c.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},c.prototype._getRangeError=function(e){var t="Input array must contain at least "+this._howMany+" items but contains only "+e+" items";return new i(t)},c.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},e.some=function(e,t){return l(e,t)},e.prototype.some=function(e){return l(this,e)},e._SomePromiseArray=c}},function(e,t,r){"use strict";e.exports=function(e,t,n){var o=r(0),i=e.TimeoutError;function s(e){this.handle=e}s.prototype._resultCancelled=function(){clearTimeout(this.handle)};var a=function(e){return u(+this).thenReturn(e)},u=e.delay=function(r,o){var i,u;return void 0!==o?(i=e.resolve(o)._then(a,null,null,r,void 0),n.cancellation()&&o instanceof e&&i._setOnCancel(o)):(i=new e(t),u=setTimeout((function(){i._fulfill()}),+r),n.cancellation()&&i._setOnCancel(new s(u)),i._captureStackTrace()),i._setAsyncGuaranteed(),i};e.prototype.delay=function(e){return u(e,this)};function c(e){return clearTimeout(this.handle),e}function l(e){throw clearTimeout(this.handle),e}e.prototype.timeout=function(e,t){var r,a;e=+e;var u=new s(setTimeout((function(){r.isPending()&&function(e,t,r){var n;n="string"!=typeof t?t instanceof Error?t:new i("operation timed out"):new i(t),o.markAsOriginatingFromRejection(n),e._attachExtraTrace(n),e._reject(n),null!=r&&r.cancel()}(r,t,a)}),e));return n.cancellation()?(a=this.then(),(r=a._then(c,l,void 0,u,void 0))._setOnCancel(u)):r=this._then(c,l,void 0,u,void 0),r}}},function(e,t,r){"use strict";e.exports=function(e,t,n,o,i,s){var a=r(0),u=r(1).TypeError,c=r(0).inherits,l=a.errorObj,h=a.tryCatch,p={};function f(e){setTimeout((function(){throw e}),0)}function d(t,r){var o=0,s=t.length,a=new e(i);return function i(){if(o>=s)return a._fulfill();var u=function(e){var t=n(e);return t!==e&&"function"==typeof e._isDisposable&&"function"==typeof e._getDisposer&&e._isDisposable()&&t._setDisposable(e._getDisposer()),t}(t[o++]);if(u instanceof e&&u._isDisposable()){try{u=n(u._getDisposer().tryDispose(r),t.promise)}catch(e){return f(e)}if(u instanceof e)return u._then(i,f,null,null,null)}i()}(),a}function _(e,t,r){this._data=e,this._promise=t,this._context=r}function v(e,t,r){this.constructor$(e,t,r)}function y(e){return _.isDisposer(e)?(this.resources[this.index]._setDisposable(e),e.promise()):e}function m(e){this.length=e,this.promise=null,this[e-1]=null}_.prototype.data=function(){return this._data},_.prototype.promise=function(){return this._promise},_.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():p},_.prototype.tryDispose=function(e){var t=this.resource(),r=this._context;void 0!==r&&r._pushContext();var n=t!==p?this.doDispose(t,e):null;return void 0!==r&&r._popContext(),this._promise._unsetDisposable(),this._data=null,n},_.isDisposer=function(e){return null!=e&&"function"==typeof e.resource&&"function"==typeof e.tryDispose},c(v,_),v.prototype.doDispose=function(e,t){return this.data().call(e,e,t)},m.prototype._resultCancelled=function(){for(var t=this.length,r=0;r<t;++r){var n=this[r];n instanceof e&&n.cancel()}},e.using=function(){var r=arguments.length;if(r<2)return t("you must pass at least 2 arguments to Promise.using");var o,i=arguments[r-1];if("function"!=typeof i)return t("expecting a function but got "+a.classString(i));var u=!0;2===r&&Array.isArray(arguments[0])?(r=(o=arguments[0]).length,u=!1):(o=arguments,r--);for(var c=new m(r),p=0;p<r;++p){var f=o[p];if(_.isDisposer(f)){var v=f;(f=f.promise())._setDisposable(v)}else{var g=n(f);g instanceof e&&(f=g._then(y,null,null,{resources:c,index:p},void 0))}c[p]=f}var b=new Array(c.length);for(p=0;p<b.length;++p)b[p]=e.resolve(c[p]).reflect();var w=e.all(b).then((function(e){for(var t=0;t<e.length;++t){var r=e[t];if(r.isRejected())return l.e=r.error(),l;if(!r.isFulfilled())return void w.cancel();e[t]=r.value()}k._pushContext(),i=h(i);var n=u?i.apply(void 0,e):i(e),o=k._popContext();return s.checkForgottenReturns(n,o,"Promise.using",k),n})),k=w.lastly((function(){var t=new e.PromiseInspection(w);return d(c,t)}));return c.promise=k,k._setOnCancel(c),k},e.prototype._setDisposable=function(e){this._bitField=131072|this._bitField,this._disposer=e},e.prototype._isDisposable=function(){return(131072&this._bitField)>0},e.prototype._getDisposer=function(){return this._disposer},e.prototype._unsetDisposable=function(){this._bitField=-131073&this._bitField,this._disposer=void 0},e.prototype.disposer=function(e){if("function"==typeof e)return new v(e,this,o());throw new u}}},function(e,t,r){"use strict";e.exports=function(e){var t=e._SomePromiseArray;function r(e){var r=new t(e),n=r.promise();return r.setHowMany(1),r.setUnwrap(),r.init(),n}e.any=function(e){return r(e)},e.prototype.any=function(){return r(this)}}},function(e,t,r){"use strict";e.exports=function(e,t){var r=e.reduce,n=e.all;function o(){return n(this)}e.prototype.each=function(e){return r(this,e,t,0)._then(o,void 0,void 0,this,void 0)},e.prototype.mapSeries=function(e){return r(this,e,t,t)},e.each=function(e,n){return r(e,n,t,0)._then(o,void 0,void 0,e,void 0)},e.mapSeries=function(e,n){return r(e,n,t,t)}}},function(e,t,r){"use strict";e.exports=function(e,t){var r=e.map;e.prototype.filter=function(e,n){return r(this,e,n,t)},e.filter=function(e,n,o){return r(e,n,o,t)}}},function(e,t,r){"use strict";(function(e){var t=r(4).getNewLibraryCopy(),n=r(57),o=r(58);try{var i=o(r.c,(function(){return r(59)}),(function(){r(18)}),e)}catch(e){var s=r(88).EOL;throw console.error(s+"###"+s+'### The "request" library is not installed automatically anymore.'+s+'### But is a dependency of "request-promise".'+s+"### Please install it with:"+s+"### npm install request --save"+s+"###"+s),e}t.config({cancellation:!0}),n({request:i,PromiseImpl:t,expose:["then","catch","finally","cancel","promise"],constructorMixin:function(e,t,r){var n=this;r((function(){n.abort()}))}}),i.bindCLS=function(){throw new Error("CLS support was dropped. To get it back read: https://github.com/request/request-promise/wiki/Getting-Back-Support-for-Continuation-Local-Storage")},e.exports=i}).call(this,r(56)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t){e.exports=require("request-promise-core/configure/request2")},function(e,t){e.exports=require("stealthy-require")},function(e,t,r){"use strict";var n=r(9),o=r(17),i=r(10).paramsHaveRequestBody;function s(e,t,r){"function"==typeof t&&(r=t);var o={};return"object"==typeof t?n(o,t,{uri:e}):n(o,"string"==typeof e?{uri:e}:e),o.callback=r||o.callback,o}function a(e,t,r){if(void 0===e)throw new Error("undefined is not a valid uri or options object.");var n=s(e,t,r);if("HEAD"===n.method&&i(n))throw new Error("HTTP HEAD requests MUST NOT include a request body.");return new a.Request(n)}function u(e){var t=e.toUpperCase();return function(e,r,n){var o=s(e,r,n);return o.method=t,a(o,o.callback)}}function c(e,t,r,o){return function(i,a,u){var c=s(i,a,u),l={};return n(!0,l,t,c),l.pool=c.pool||t.pool,o&&(l.method=o.toUpperCase()),"function"==typeof r&&(e=r),e(l,l.callback)}}a.get=u("get"),a.head=u("head"),a.options=u("options"),a.post=u("post"),a.put=u("put"),a.patch=u("patch"),a.del=u("delete"),a.delete=u("delete"),a.jar=function(e){return o.jar(e)},a.cookie=function(e){return o.parse(e)},a.defaults=function(e,t){var r=this;"function"==typeof(e=e||{})&&(t=e,e={});var n=c(r,e,t);return["get","head","post","put","patch","del","delete"].forEach((function(o){n[o]=c(r[o],e,t,o)})),n.cookie=c(r.cookie,e,t),n.jar=r.jar,n.defaults=r.defaults,n},a.forever=function(e,t){var r={};return t&&n(r,t),e&&(r.agentOptions=e),r.forever=!0,a.defaults(r)},e.exports=a,a.Request=r(61),a.initParams=s,Object.defineProperty(a,"debug",{enumerable:!0,get:function(){return a.Request.debug},set:function(e){a.Request.debug=e}})},function(e,t){e.exports=require("json-stringify-safe")},function(e,t,r){"use strict";var n=r(62),o=r(63),i=r(6),s=r(64),a=r(19),u=r(65),c=r(66),l=r(67),h=r(68),p=r(69),f=r(11),d=r(70),_=r(71),v=r(9),y=r(20),m=r(72).strict,g=r(10),b=r(17),w=r(73),k=r(74).Querystring,C=r(75).Har,x=r(78).Auth,j=r(79).OAuth,E=r(81),S=r(82).Multipart,O=r(84).Redirect,T=r(85).Tunnel,R=r(87),P=r(5).Buffer,F=g.safeStringify,A=g.isReadStream,H=g.toBase64,q=g.defer,D=g.copy,N=g.version,L=b.jar(),U={};function M(){return{uri:this.uri,method:this.method,headers:this.headers}}function I(){return{statusCode:this.statusCode,body:this.body,headers:this.headers,request:M.call(this.request)}}function B(e){e.har&&(this._har=new C(this),e=this._har.options(e)),a.Stream.call(this);var t=Object.keys(B.prototype),r=function(e,t){var r={};for(var n in t){-1===e.indexOf(n)&&(r[n]=t[n])}return r}(t,e);v(this,r),e=function(e,t){var r={};for(var n in t){var o=!(-1===e.indexOf(n)),i="function"==typeof t[n];o&&i||(r[n]=t[n])}return r}(t,e),this.readable=!0,this.writable=!0,e.method&&(this.explicitMethod=!0),this._qs=new k(this),this._auth=new x(this),this._oauth=new j(this),this._multipart=new S(this),this._redirect=new O(this),this._tunnel=new T(this),this.init(e)}function z(){B.debug&&console.error("REQUEST %s",s.format.apply(s,arguments))}s.inherits(B,a.Stream),B.debug=process.env.NODE_DEBUG&&/\brequest\b/.test(process.env.NODE_DEBUG),B.prototype.debug=z,B.prototype.init=function(e){var t=this;for(var r in e||(e={}),t.headers=t.headers?D(t.headers):{},t.headers)void 0===t.headers[r]&&delete t.headers[r];if(f.httpify(t,t.headers),t.method||(t.method=e.method||"GET"),t.localAddress||(t.localAddress=e.localAddress),t._qs.init(e),z(e),t.pool||!1===t.pool||(t.pool=U),t.dests=t.dests||[],t.__isRequestRequest=!0,!t._callback&&t.callback&&(t._callback=t.callback,t.callback=function(){t._callbackCalled||(t._callbackCalled=!0,t._callback.apply(t,arguments))},t.on("error",t.callback.bind()),t.on("complete",t.callback.bind(t,null))),!t.uri&&t.url&&(t.uri=t.url,delete t.url),t.baseUrl){if("string"!=typeof t.baseUrl)return t.emit("error",new Error("options.baseUrl must be a string"));if("string"!=typeof t.uri)return t.emit("error",new Error("options.uri must be a string when using options.baseUrl"));if(0===t.uri.indexOf("//")||-1!==t.uri.indexOf("://"))return t.emit("error",new Error("options.uri must be a path when using options.baseUrl"));var s=t.baseUrl.lastIndexOf("/")===t.baseUrl.length-1,a=0===t.uri.indexOf("/");s&&a?t.uri=t.baseUrl+t.uri.slice(1):s||a?t.uri=t.baseUrl+t.uri:""===t.uri?t.uri=t.baseUrl:t.uri=t.baseUrl+"/"+t.uri,delete t.baseUrl}if(!t.uri)return t.emit("error",new Error("options.uri is a required argument"));if("string"==typeof t.uri&&(t.uri=i.parse(t.uri)),t.uri.href||(t.uri.href=i.format(t.uri)),"unix:"===t.uri.protocol)return t.emit("error",new Error("`unix://` URL scheme is no longer supported. Please use the format `http://unix:SOCKET:PATH`"));if("unix"===t.uri.host&&t.enableUnixSocket(),!1===t.strictSSL&&(t.rejectUnauthorized=!1),t.uri.pathname||(t.uri.pathname="/"),!(t.uri.host||t.uri.hostname&&t.uri.port||t.uri.isUnix)){var u='Invalid URI "'+i.format(t.uri)+'"';return 0===Object.keys(e).length&&(u+=". This can be caused by a crappy redirection."),t.abort(),t.emit("error",new Error(u))}if(t.hasOwnProperty("proxy")||(t.proxy=w(t.uri)),t.tunnel=t._tunnel.isEnabled(),t.proxy&&t._tunnel.setup(e),t._redirect.onRequest(e),t.setHost=!1,!t.hasHeader("host")){var c=t.originalHostHeaderName||"host";t.setHeader(c,t.uri.host),t.uri.port&&("80"===t.uri.port&&"http:"===t.uri.protocol||"443"===t.uri.port&&"https:"===t.uri.protocol)&&t.setHeader(c,t.uri.hostname),t.setHost=!0}if(t.jar(t._jar||e.jar),t.uri.port||("http:"===t.uri.protocol?t.uri.port=80:"https:"===t.uri.protocol&&(t.uri.port=443)),t.proxy&&!t.tunnel?(t.port=t.proxy.port,t.host=t.proxy.hostname):(t.port=t.uri.port,t.host=t.uri.hostname),e.form&&t.form(e.form),e.formData){var l=e.formData,h=t.form(),_=function(e,t){t&&t.hasOwnProperty("value")&&t.hasOwnProperty("options")?h.append(e,t.value,t.options):h.append(e,t)};for(var v in l)if(l.hasOwnProperty(v)){var g=l[v];if(g instanceof Array)for(var b=0;b<g.length;b++)_(v,g[b]);else _(v,g)}}if(e.qs&&t.qs(e.qs),t.uri.path?t.path=t.uri.path:t.path=t.uri.pathname+(t.uri.search||""),0===t.path.length&&(t.path="/"),e.aws&&t.aws(e.aws),e.hawk&&t.hawk(e.hawk),e.httpSignature&&t.httpSignature(e.httpSignature),e.auth&&(Object.prototype.hasOwnProperty.call(e.auth,"username")&&(e.auth.user=e.auth.username),Object.prototype.hasOwnProperty.call(e.auth,"password")&&(e.auth.pass=e.auth.password),t.auth(e.auth.user,e.auth.pass,e.auth.sendImmediately,e.auth.bearer)),t.gzip&&!t.hasHeader("accept-encoding")&&t.setHeader("accept-encoding","gzip, deflate"),t.uri.auth&&!t.hasHeader("authorization")){var k=t.uri.auth.split(":").map((function(e){return t._qs.unescape(e)}));t.auth(k[0],k.slice(1).join(":"),!0)}if(!t.tunnel&&t.proxy&&t.proxy.auth&&!t.hasHeader("proxy-authorization")){var C=t.proxy.auth.split(":").map((function(e){return t._qs.unescape(e)})),x="Basic "+H(C.join(":"));t.setHeader("proxy-authorization",x)}function j(){var e;(m(t.body)&&(t.body=P.from(t.body)),t.hasHeader("content-length"))||((e="string"==typeof t.body?P.byteLength(t.body):Array.isArray(t.body)?t.body.reduce((function(e,t){return e+t.length}),0):t.body.length)?t.setHeader("content-length",e):t.emit("error",new Error("Argument error, options.body.")))}t.proxy&&!t.tunnel&&(t.path=t.uri.protocol+"//"+t.uri.host+t.path),e.json&&t.json(e.json),e.multipart&&t.multipart(e.multipart),e.time&&(t.timing=!0,t.elapsedTime=t.elapsedTime||0),t.body&&!y(t.body)&&j(),e.oauth?t.oauth(e.oauth):t._oauth.params&&t.hasHeader("authorization")&&t.oauth(t._oauth.params);var E=t.proxy&&!t.tunnel?t.proxy.protocol:t.uri.protocol,S={"http:":n,"https:":o},O=t.httpModules||{};if(t.httpModule=O[E]||S[E],!t.httpModule)return t.emit("error",new Error("Invalid protocol: "+E));if(e.ca&&(t.ca=e.ca),!t.agent)if(e.agentOptions&&(t.agentOptions=e.agentOptions),e.agentClass)t.agentClass=e.agentClass;else if(e.forever){var T=N();0===T.major&&T.minor<=10?t.agentClass="http:"===E?d:d.SSL:(t.agentClass=t.httpModule.Agent,t.agentOptions=t.agentOptions||{},t.agentOptions.keepAlive=!0)}else t.agentClass=t.httpModule.Agent;!1===t.pool?t.agent=!1:t.agent=t.agent||t.getNewAgent(),t.on("pipe",(function(e){if(t.ntick&&t._started&&t.emit("error",new Error("You cannot pipe to this stream after the outbound request has started.")),t.src=e,A(e))t.hasHeader("content-type")||t.setHeader("content-type",p.lookup(e.path));else{if(e.headers)for(var r in e.headers)t.hasHeader(r)||t.setHeader(r,e.headers[r]);t._json&&!t.hasHeader("content-type")&&t.setHeader("content-type","application/json"),e.method&&!t.explicitMethod&&(t.method=e.method)}})),q((function(){if(!t._aborted){var e=function(){if(t._form&&(t._auth.hasAuth?t._auth.hasAuth&&t._auth.sentAuth&&t._form.pipe(t):t._form.pipe(t)),t._multipart&&t._multipart.chunked&&t._multipart.body.pipe(t),t.body)y(t.body)?t.body.pipe(t):(j(),Array.isArray(t.body)?t.body.forEach((function(e){t.write(e)})):t.write(t.body),t.end());else if(t.requestBodyStream)console.warn("options.requestBodyStream is deprecated, please pass the request object to stream.pipe."),t.requestBodyStream.pipe(t);else if(!t.src){if(t._auth.hasAuth&&!t._auth.sentAuth)return void t.end();"GET"!==t.method&&void 0!==t.method&&t.setHeader("content-length",0),t.end()}};t._form&&!t.hasHeader("content-length")?(t.setHeader(t._form.getHeaders(),!0),t._form.getLength((function(r,n){r||isNaN(n)||t.setHeader("content-length",n),e()}))):e(),t.ntick=!0}}))},B.prototype.getNewAgent=function(){var e=this.agentClass,t={};if(this.agentOptions)for(var r in this.agentOptions)t[r]=this.agentOptions[r];this.ca&&(t.ca=this.ca),this.ciphers&&(t.ciphers=this.ciphers),this.secureProtocol&&(t.secureProtocol=this.secureProtocol),this.secureOptions&&(t.secureOptions=this.secureOptions),void 0!==this.rejectUnauthorized&&(t.rejectUnauthorized=this.rejectUnauthorized),this.cert&&this.key&&(t.key=this.key,t.cert=this.cert),this.pfx&&(t.pfx=this.pfx),this.passphrase&&(t.passphrase=this.passphrase);var n="";e!==this.httpModule.Agent&&(n+=e.name);var o=this.proxy;return"string"==typeof o&&(o=i.parse(o)),(o&&"https:"===o.protocol||"https:"===this.uri.protocol)&&(t.ca&&(n&&(n+=":"),n+=t.ca),void 0!==t.rejectUnauthorized&&(n&&(n+=":"),n+=t.rejectUnauthorized),t.cert&&(n&&(n+=":"),n+=t.cert.toString("ascii")+t.key.toString("ascii")),t.pfx&&(n&&(n+=":"),n+=t.pfx.toString("ascii")),t.ciphers&&(n&&(n+=":"),n+=t.ciphers),t.secureProtocol&&(n&&(n+=":"),n+=t.secureProtocol),t.secureOptions&&(n&&(n+=":"),n+=t.secureOptions)),this.pool===U&&!n&&0===Object.keys(t).length&&this.httpModule.globalAgent?this.httpModule.globalAgent:(n=this.uri.protocol+n,this.pool[n]||(this.pool[n]=new e(t),this.pool.maxSockets&&(this.pool[n].maxSockets=this.pool.maxSockets)),this.pool[n])},B.prototype.start=function(){var e=this;if(e.timing)var t=(new Date).getTime(),r=R();if(!e._aborted){e._started=!0,e.method=e.method||"GET",e.href=e.uri.href,e.src&&e.src.stat&&e.src.stat.size&&!e.hasHeader("content-length")&&e.setHeader("content-length",e.src.stat.size),e._aws&&e.aws(e._aws,!0);var n,o=D(e);delete o.auth,z("make request",e.uri.href),delete o.timeout;try{e.req=e.httpModule.request(o)}catch(t){return void e.emit("error",t)}e.timing&&(e.startTime=t,e.startTimeNow=r,e.timings={}),e.timeout&&!e.timeoutTimer&&(e.timeout<0?n=0:"number"==typeof e.timeout&&isFinite(e.timeout)&&(n=e.timeout)),e.req.on("response",e.onRequestResponse.bind(e)),e.req.on("error",e.onRequestError.bind(e)),e.req.on("drain",(function(){e.emit("drain")})),e.req.on("socket",(function(t){var r=t._connecting||t.connecting;if(e.timing&&(e.timings.socket=R()-e.startTimeNow,r)){var o=function(){e.timings.lookup=R()-e.startTimeNow},i=function(){e.timings.connect=R()-e.startTimeNow};t.once("lookup",o),t.once("connect",i),e.req.once("error",(function(){t.removeListener("lookup",o),t.removeListener("connect",i)}))}var s=function(){e.req.setTimeout(n,(function(){if(e.req){e.abort();var t=new Error("ESOCKETTIMEDOUT");t.code="ESOCKETTIMEDOUT",t.connect=!1,e.emit("error",t)}}))};if(void 0!==n)if(r){var a=function(){t.removeListener("connect",a),clearTimeout(e.timeoutTimer),e.timeoutTimer=null,s()};t.on("connect",a),e.req.on("error",(function(e){t.removeListener("connect",a)})),e.timeoutTimer=setTimeout((function(){t.removeListener("connect",a),e.abort();var r=new Error("ETIMEDOUT");r.code="ETIMEDOUT",r.connect=!0,e.emit("error",r)}),n)}else s();e.emit("socket",t)})),e.emit("request",e.req)}},B.prototype.onRequestError=function(e){if(!this._aborted){if(this.req&&this.req._reusedSocket&&"ECONNRESET"===e.code&&this.agent.addRequestNoreuse)return this.agent={addRequest:this.agent.addRequestNoreuse.bind(this.agent)},this.start(),void this.req.end();this.timeout&&this.timeoutTimer&&(clearTimeout(this.timeoutTimer),this.timeoutTimer=null),this.emit("error",e)}},B.prototype.onRequestResponse=function(e){var t=this;if(t.timing&&(t.timings.response=R()-t.startTimeNow),z("onRequestResponse",t.uri.href,e.statusCode,e.headers),e.on("end",(function(){t.timing&&(t.timings.end=R()-t.startTimeNow,e.timingStart=t.startTime,t.timings.socket||(t.timings.socket=0),t.timings.lookup||(t.timings.lookup=t.timings.socket),t.timings.connect||(t.timings.connect=t.timings.lookup),t.timings.response||(t.timings.response=t.timings.connect),z("elapsed time",t.timings.end),t.elapsedTime+=Math.round(t.timings.end),e.elapsedTime=t.elapsedTime,e.timings=t.timings,e.timingPhases={wait:t.timings.socket,dns:t.timings.lookup-t.timings.socket,tcp:t.timings.connect-t.timings.lookup,firstByte:t.timings.response-t.timings.connect,download:t.timings.end-t.timings.response,total:t.timings.end}),z("response end",t.uri.href,e.statusCode,e.headers)})),t._aborted)return z("aborted",t.uri.href),void e.resume();if(t.response=e,e.request=t,e.toJSON=I,t.httpModule!==o||!t.strictSSL||e.hasOwnProperty("socket")&&e.socket.authorized){t.originalHost=t.getHeader("host"),t.originalHostHeaderName||(t.originalHostHeaderName=t.hasHeader("host")),t.setHost&&t.removeHeader("host"),t.timeout&&t.timeoutTimer&&(clearTimeout(t.timeoutTimer),t.timeoutTimer=null);var r=t._jar&&t._jar.setCookie?t._jar:L,n=function(e){try{r.setCookie(e,t.uri.href,{ignoreError:!0})}catch(e){t.emit("error",e)}};if(e.caseless=f(e.headers),e.caseless.has("set-cookie")&&!t._disableCookies){var i=e.caseless.has("set-cookie");Array.isArray(e.headers[i])?e.headers[i].forEach(n):n(e.headers[i])}if(!t._redirect.onResponse(e)){e.on("close",(function(){t._ended||t.response.emit("end")})),e.once("end",(function(){t._ended=!0}));var s,a;if(!t.gzip||(a=e.statusCode,"HEAD"===t.method||a>=100&&a<200||204===a||304===a))s=e;else{var c=e.headers["content-encoding"]||"identity";c=c.trim().toLowerCase();var l={flush:u.Z_SYNC_FLUSH,finishFlush:u.Z_SYNC_FLUSH};"gzip"===c?(s=u.createGunzip(l),e.pipe(s)):"deflate"===c?(s=u.createInflate(l),e.pipe(s)):("identity"!==c&&z("ignoring unrecognized Content-Encoding "+c),s=e)}t.encoding&&(0!==t.dests.length?console.error("Ignoring encoding parameter as this stream is being piped to another stream which makes the encoding option invalid."):s.setEncoding(t.encoding)),t._paused&&s.pause(),t.responseContent=s,t.emit("response",e),t.dests.forEach((function(e){t.pipeDest(e)})),s.on("data",(function(r){t.timing&&!t.responseStarted&&(t.responseStartTime=(new Date).getTime(),e.responseStartTime=t.responseStartTime),t._destdata=!0,t.emit("data",r)})),s.once("end",(function(e){t.emit("end",e)})),s.on("error",(function(e){t.emit("error",e)})),s.on("close",(function(){t.emit("close")})),t.callback?t.readResponseBody(e):t.on("end",(function(){t._aborted?z("aborted",t.uri.href):t.emit("complete",e)})),z("finish init function",t.uri.href)}}else{z("strict ssl error",t.uri.href);var h=e.hasOwnProperty("socket")?e.socket.authorizationError:t.uri.href+" does not support SSL";t.emit("error",new Error("SSL Error: "+h))}},B.prototype.readResponseBody=function(e){var t=this;z("reading response's body");var r=[],n=0,o=[];t.on("data",(function(e){P.isBuffer(e)?e.length&&(n+=e.length,r.push(e)):o.push(e)})),t.on("end",(function(){if(z("end event",t.uri.href),t._aborted)return z("aborted",t.uri.href),r=[],void(n=0);if(n?(z("has body",t.uri.href,n),e.body=P.concat(r,n),null!==t.encoding&&(e.body=e.body.toString(t.encoding)),r=[],n=0):o.length&&("utf8"===t.encoding&&o[0].length>0&&"\ufeff"===o[0][0]&&(o[0]=o[0].substring(1)),e.body=o.join("")),t._json)try{e.body=JSON.parse(e.body,t._jsonReviver)}catch(e){z("invalid JSON received",t.uri.href)}z("emitting complete",t.uri.href),void 0!==e.body||t._json||(e.body=null===t.encoding?P.alloc(0):""),t.emit("complete",e,e.body)}))},B.prototype.abort=function(){this._aborted=!0,this.req?this.req.abort():this.response&&this.response.destroy(),this.emit("abort")},B.prototype.pipeDest=function(e){var t=this.response;if(e.headers&&!e.headersSent){if(t.caseless.has("content-type")){var r=t.caseless.has("content-type");e.setHeader?e.setHeader(r,t.headers[r]):e.headers[r]=t.headers[r]}if(t.caseless.has("content-length")){var n=t.caseless.has("content-length");e.setHeader?e.setHeader(n,t.headers[n]):e.headers[n]=t.headers[n]}}if(e.setHeader&&!e.headersSent){for(var o in t.headers)this.gzip&&"content-encoding"===o||e.setHeader(o,t.headers[o]);e.statusCode=t.statusCode}this.pipefilter&&this.pipefilter(t,e)},B.prototype.qs=function(e,t){var r;for(var n in r=!t&&this.uri.query?this._qs.parse(this.uri.query):{},e)r[n]=e[n];var o=this._qs.stringify(r);return""===o?this:(this.uri=i.parse(this.uri.href.split("?")[0]+"?"+o),this.url=this.uri,this.path=this.uri.path,"unix"===this.uri.host&&this.enableUnixSocket(),this)},B.prototype.form=function(e){var t=this;return e?(/^application\/x-www-form-urlencoded\b/.test(t.getHeader("content-type"))||t.setHeader("content-type","application/x-www-form-urlencoded"),t.body="string"==typeof e?t._qs.rfc3986(e.toString("utf8")):t._qs.stringify(e).toString("utf8"),t):(t._form=new _,t._form.on("error",(function(e){e.message="form-data: "+e.message,t.emit("error",e),t.abort()})),t._form)},B.prototype.multipart=function(e){return this._multipart.onRequest(e),this._multipart.chunked||(this.body=this._multipart.body),this},B.prototype.json=function(e){return this.hasHeader("accept")||this.setHeader("accept","application/json"),"function"==typeof this.jsonReplacer&&(this._jsonReplacer=this.jsonReplacer),this._json=!0,"boolean"==typeof e?void 0!==this.body&&(/^application\/x-www-form-urlencoded\b/.test(this.getHeader("content-type"))?this.body=this._qs.rfc3986(this.body):this.body=F(this.body,this._jsonReplacer),this.hasHeader("content-type")||this.setHeader("content-type","application/json")):(this.body=F(e,this._jsonReplacer),this.hasHeader("content-type")||this.setHeader("content-type","application/json")),"function"==typeof this.jsonReviver&&(this._jsonReviver=this.jsonReviver),this},B.prototype.getHeader=function(e,t){var r,n;return t||(t=this.headers),Object.keys(t).forEach((function(o){o.length===e.length&&(n=new RegExp(e,"i"),o.match(n)&&(r=t[o]))})),r},B.prototype.enableUnixSocket=function(){var e=this.uri.path.split(":"),t=e[0],r=e[1];this.socketPath=t,this.uri.pathname=r,this.uri.path=r,this.uri.host=t,this.uri.hostname=t,this.uri.isUnix=!0},B.prototype.auth=function(e,t,r,n){return this._auth.onRequest(e,t,r,n),this},B.prototype.aws=function(e,t){if(!t)return this._aws=e,this;if(4===e.sign_version||"4"===e.sign_version){var r={host:this.uri.host,path:this.uri.path,method:this.method,headers:this.headers,body:this.body};e.service&&(r.service=e.service);var n=l.sign(r,{accessKeyId:e.key,secretAccessKey:e.secret,sessionToken:e.session});this.setHeader("authorization",n.headers.Authorization),this.setHeader("x-amz-date",n.headers["X-Amz-Date"]),n.headers["X-Amz-Security-Token"]&&this.setHeader("x-amz-security-token",n.headers["X-Amz-Security-Token"])}else{var o=new Date;this.setHeader("date",o.toUTCString());var i={key:e.key,secret:e.secret,verb:this.method.toUpperCase(),date:o,contentType:this.getHeader("content-type")||"",md5:this.getHeader("content-md5")||"",amazonHeaders:c.canonicalizeHeaders(this.headers)},s=this.uri.path;e.bucket&&s?i.resource="/"+e.bucket+s:e.bucket&&!s?i.resource="/"+e.bucket:!e.bucket&&s?i.resource=s:e.bucket||s||(i.resource="/"),i.resource=c.canonicalizeResource(i.resource),this.setHeader("authorization",c.authorization(i))}return this},B.prototype.httpSignature=function(e){var t=this;return h.signRequest({getHeader:function(e){return t.getHeader(e,t.headers)},setHeader:function(e,r){t.setHeader(e,r)},method:t.method,path:t.path},e),z("httpSignature authorization",t.getHeader("authorization")),t},B.prototype.hawk=function(e){this.setHeader("Authorization",E.header(this.uri,this.method,e))},B.prototype.oauth=function(e){return this._oauth.onRequest(e),this},B.prototype.jar=function(e){var t;if(0===this._redirect.redirectsFollowed&&(this.originalCookieHeader=this.getHeader("cookie")),e){var r=e&&e.getCookieString?e:L,n=this.uri.href;r&&(t=r.getCookieString(n))}else t=!1,this._disableCookies=!0;return t&&t.length&&(this.originalCookieHeader?this.setHeader("cookie",this.originalCookieHeader+"; "+t):this.setHeader("cookie",t)),this._jar=e,this},B.prototype.pipe=function(e,t){if(!this.response)return this.dests.push(e),a.Stream.prototype.pipe.call(this,e,t),e;if(this._destdata)this.emit("error",new Error("You cannot pipe after data has been emitted from the response."));else{if(!this._ended)return a.Stream.prototype.pipe.call(this,e,t),this.pipeDest(e),e;this.emit("error",new Error("You cannot pipe after the response has been ended."))}},B.prototype.write=function(){var e=this;if(!e._aborted)return e._started||e.start(),e.req?e.req.write.apply(e.req,arguments):void 0},B.prototype.end=function(e){this._aborted||(e&&this.write(e),this._started||this.start(),this.req&&this.req.end())},B.prototype.pause=function(){var e=this;e.responseContent?e.responseContent.pause.apply(e.responseContent,arguments):e._paused=!0},B.prototype.resume=function(){var e=this;e.responseContent?e.responseContent.resume.apply(e.responseContent,arguments):e._paused=!1},B.prototype.destroy=function(){this._ended?this.response&&this.response.destroy():this.end()},B.defaultProxyHeaderWhiteList=T.defaultProxyHeaderWhiteList.slice(),B.defaultProxyHeaderExclusiveList=T.defaultProxyHeaderExclusiveList.slice(),B.prototype.toJSON=M,e.exports=B},function(e,t){e.exports=require("http")},function(e,t){e.exports=require("https")},function(e,t){e.exports=require("util")},function(e,t){e.exports=require("zlib")},function(e,t){e.exports=require("aws-sign2")},function(e,t){e.exports=require("aws4")},function(e,t){e.exports=require("http-signature")},function(e,t){e.exports=require("mime-types")},function(e,t){e.exports=require("forever-agent")},function(e,t){e.exports=require("form-data")},function(e,t){e.exports=require("is-typedarray")},function(e,t,r){"use strict";function n(e){return e.replace(/^\.*/,".").toLowerCase()}function o(e){var t=(e=e.trim().toLowerCase()).split(":",2);return{hostname:n(t[0]),port:t[1],hasPort:e.indexOf(":")>-1}}e.exports=function(e){var t=process.env.NO_PROXY||process.env.no_proxy||"";return"*"===t?null:""!==t&&function(e,t){var r=e.port||("https:"===e.protocol?"443":"80"),i=n(e.hostname);return t.split(",").map(o).some((function(e){var t=i.indexOf(e.hostname),n=t>-1&&t===i.length-e.hostname.length;return e.hasPort?r===e.port&&n:n}))}(e,t)?null:"http:"===e.protocol?process.env.HTTP_PROXY||process.env.http_proxy||null:"https:"===e.protocol&&(process.env.HTTPS_PROXY||process.env.https_proxy||process.env.HTTP_PROXY||process.env.http_proxy)||null}},function(e,t,r){"use strict";var n=r(21),o=r(8);function i(e){this.request=e,this.lib=null,this.useQuerystring=null,this.parseOptions=null,this.stringifyOptions=null}i.prototype.init=function(e){this.lib||(this.useQuerystring=e.useQuerystring,this.lib=this.useQuerystring?o:n,this.parseOptions=e.qsParseOptions||{},this.stringifyOptions=e.qsStringifyOptions||{})},i.prototype.stringify=function(e){return this.useQuerystring?this.rfc3986(this.lib.stringify(e,this.stringifyOptions.sep||null,this.stringifyOptions.eq||null,this.stringifyOptions)):this.lib.stringify(e,this.stringifyOptions)},i.prototype.parse=function(e){return this.useQuerystring?this.lib.parse(e,this.parseOptions.sep||null,this.parseOptions.eq||null,this.parseOptions):this.lib.parse(e,this.parseOptions)},i.prototype.rfc3986=function(e){return e.replace(/[!'()*]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))},i.prototype.unescape=o.unescape,t.Querystring=i},function(e,t,r){"use strict";var n=r(76),o=r(8),i=r(77),s=r(9);function a(e){this.request=e}a.prototype.reducer=function(e,t){if(void 0===e[t.name])return e[t.name]=t.value,e;var r=[e[t.name],t.value];return e[t.name]=r,e},a.prototype.prep=function(e){if(e.queryObj={},e.headersObj={},e.postData.jsonObj=!1,e.postData.paramsObj=!1,e.queryString&&e.queryString.length&&(e.queryObj=e.queryString.reduce(this.reducer,{})),e.headers&&e.headers.length&&(e.headersObj=e.headers.reduceRight((function(e,t){return e[t.name]=t.value,e}),{})),e.cookies&&e.cookies.length){var t=e.cookies.map((function(e){return e.name+"="+e.value}));t.length&&(e.headersObj.cookie=t.join("; "))}function r(t){return t.some((function(t){return 0===e.postData.mimeType.indexOf(t)}))}if(r(["multipart/mixed","multipart/related","multipart/form-data","multipart/alternative"]))e.postData.mimeType="multipart/form-data";else if(r(["application/x-www-form-urlencoded"]))e.postData.params?(e.postData.paramsObj=e.postData.params.reduce(this.reducer,{}),e.postData.text=o.stringify(e.postData.paramsObj)):e.postData.text="";else if(r(["text/json","text/x-json","application/json","application/x-json"])&&(e.postData.mimeType="application/json",e.postData.text))try{e.postData.jsonObj=JSON.parse(e.postData.text)}catch(t){this.request.debug(t),e.postData.mimeType="text/plain"}return e},a.prototype.options=function(e){if(!e.har)return e;var t={};if(s(t,e.har),t.log&&t.log.entries&&(t=t.log.entries[0]),t.url=t.url||e.url||e.uri||e.baseUrl||"/",t.httpVersion=t.httpVersion||"HTTP/1.1",t.queryString=t.queryString||[],t.headers=t.headers||[],t.cookies=t.cookies||[],t.postData=t.postData||{},t.postData.mimeType=t.postData.mimeType||"application/octet-stream",t.bodySize=0,t.headersSize=0,t.postData.size=0,!i.request(t))return e;var r=this.prep(t);function o(e){return 0===r.postData.mimeType.indexOf(e)}return r.url&&(e.url=r.url),r.method&&(e.method=r.method),Object.keys(r.queryObj).length&&(e.qs=r.queryObj),Object.keys(r.headersObj).length&&(e.headers=r.headersObj),o("application/x-www-form-urlencoded")?e.form=r.postData.paramsObj:o("application/json")?r.postData.jsonObj&&(e.body=r.postData.jsonObj,e.json=!0):o("multipart/form-data")?(e.formData={},r.postData.params.forEach((function(t){var r={};t.fileName||t.fileName||t.contentType?(t.fileName&&!t.value?r.value=n.createReadStream(t.fileName):t.value&&(r.value=t.value),t.fileName&&(r.options={filename:t.fileName,contentType:t.contentType?t.contentType:null}),e.formData[t.name]=r):e.formData[t.name]=t.value}))):r.postData.text&&(e.body=r.postData.text),e},t.Har=a},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("har-validator")},function(e,t,r){"use strict";var n=r(11),o=r(12),i=r(10),s=i.md5,a=i.toBase64;function u(e){this.request=e,this.hasAuth=!1,this.sentAuth=!1,this.bearerToken=null,this.user=null,this.pass=null}u.prototype.basic=function(e,t,r){if(("string"!=typeof e||void 0!==t&&"string"!=typeof t)&&this.request.emit("error",new Error("auth() received invalid user or password")),this.user=e,this.pass=t,this.hasAuth=!0,r||void 0===r){var n="Basic "+a(e+":"+(t||""));return this.sentAuth=!0,n}},u.prototype.bearer=function(e,t){if(this.bearerToken=e,this.hasAuth=!0,t||void 0===t){"function"==typeof e&&(e=e());var r="Bearer "+(e||"");return this.sentAuth=!0,r}},u.prototype.digest=function(e,t,r){for(var n={},i=/([a-z0-9_-]+)=(?:"([^"]+)"|([a-z0-9_-]+))/gi;;){var a=i.exec(r);if(!a)break;n[a[1]]=a[2]||a[3]}var u=/(^|,)\s*auth\s*($|,)/.test(n.qop)&&"auth",c=u&&"00000001",l=u&&o().replace(/-/g,""),h=function(e,t,r,n,o,i){var a=s(t+":"+r+":"+n);return e&&"md5-sess"===e.toLowerCase()?s(a+":"+o+":"+i):a}(n.algorithm,this.user,n.realm,this.pass,n.nonce,l),p=s(e+":"+t),f=s(u?h+":"+n.nonce+":"+c+":"+l+":"+u+":"+p:h+":"+n.nonce+":"+p),d={username:this.user,realm:n.realm,nonce:n.nonce,uri:t,qop:u,response:f,nc:c,cnonce:l,algorithm:n.algorithm,opaque:n.opaque};for(var _ in r=[],d)d[_]&&("qop"===_||"nc"===_||"algorithm"===_?r.push(_+"="+d[_]):r.push(_+'="'+d[_]+'"'));return r="Digest "+r.join(", "),this.sentAuth=!0,r},u.prototype.onRequest=function(e,t,r,n){var o,i=this.request;void 0===n&&void 0===e?this.request.emit("error",new Error("no auth mechanism defined")):o=void 0!==n?this.bearer(n,r):this.basic(e,t,r),o&&i.setHeader("authorization",o)},u.prototype.onResponse=function(e){var t=this.request;if(!this.hasAuth||this.sentAuth)return null;var r=n(e.headers).get("www-authenticate"),o=r&&r.split(" ")[0].toLowerCase();switch(t.debug("reauth",o),o){case"basic":return this.basic(this.user,this.pass,!0);case"bearer":return this.bearer(this.bearerToken,!0);case"digest":return this.digest(t.method,t.path,r)}},t.Auth=u},function(e,t,r){"use strict";var n=r(6),o=r(21),i=r(11),s=r(12),a=r(80),u=r(3),c=r(5).Buffer;function l(e){this.request=e,this.params=null}l.prototype.buildParams=function(e,t,r,n,o,i){var u={};for(var c in e)u["oauth_"+c]=e[c];u.oauth_version||(u.oauth_version="1.0"),u.oauth_timestamp||(u.oauth_timestamp=Math.floor(Date.now()/1e3).toString()),u.oauth_nonce||(u.oauth_nonce=s().replace(/-/g,"")),u.oauth_signature_method||(u.oauth_signature_method="HMAC-SHA1");var l=u.oauth_consumer_secret||u.oauth_private_key;delete u.oauth_consumer_secret,delete u.oauth_private_key;var h=u.oauth_token_secret;delete u.oauth_token_secret;var p=u.oauth_realm;delete u.oauth_realm,delete u.oauth_transport_method;var f=t.protocol+"//"+t.host+t.pathname,d=i.parse([].concat(n,o,i.stringify(u)).join("&"));return u.oauth_signature=a.sign(u.oauth_signature_method,r,f,d,l,h),p&&(u.realm=p),u},l.prototype.buildBodyHash=function(e,t){["HMAC-SHA1","RSA-SHA1"].indexOf(e.signature_method||"HMAC-SHA1")<0&&this.request.emit("error",new Error("oauth: "+e.signature_method+" signature_method not supported with body_hash signing."));var r=u.createHash("sha1");r.update(t||"");var n=r.digest("hex");return c.from(n,"hex").toString("base64")},l.prototype.concatParams=function(e,t,r){r=r||"";var n=Object.keys(e).filter((function(e){return"realm"!==e&&"oauth_signature"!==e})).sort();return e.realm&&n.splice(0,0,"realm"),n.push("oauth_signature"),n.map((function(t){return t+"="+r+a.rfc3986(e[t])+r})).join(t)},l.prototype.onRequest=function(e){this.params=e;var t,r,s=this.request.uri||{},a=this.request.method||"",u=i(this.request.headers),c=this.request.body||"",l=this.request.qsLib||o,h=u.get("content-type")||"",p="application/x-www-form-urlencoded",f=e.transport_method||"header";h.slice(0,p.length)===p&&(h=p,t=c),s.query&&(r=s.query),"body"!==f||"POST"===a&&h===p||this.request.emit("error",new Error("oauth: transport_method of body requires POST and content-type "+p)),t||"boolean"!=typeof e.body_hash||(e.body_hash=this.buildBodyHash(e,this.request.body.toString()));var d=this.buildParams(e,s,a,r,t,l);switch(f){case"header":this.request.setHeader("Authorization","OAuth "+this.concatParams(d,",",'"'));break;case"query":var _=this.request.uri.href+=(r?"&":"?")+this.concatParams(d,"&");this.request.uri=n.parse(_),this.request.path=this.request.uri.path;break;case"body":this.request.body=(t?t+"&":"")+this.concatParams(d,"&");break;default:this.request.emit("error",new Error("oauth: transport_method invalid"))}},t.OAuth=l},function(e,t){e.exports=require("oauth-sign")},function(e,t,r){"use strict";var n=r(3);t.calculateMac=function(e,t){var r="hawk.1.header\n"+t.ts+"\n"+t.nonce+"\n"+(t.method||"").toUpperCase()+"\n"+t.resource+"\n"+t.host.toLowerCase()+"\n"+t.port+"\n"+(t.hash||"")+"\n";return t.ext&&(r+=t.ext.replace("\\","\\\\").replace("\n","\\n")),r+="\n",t.app&&(r=r+t.app+"\n"+(t.dlg||"")+"\n"),n.createHmac(e.algorithm,e.key).update(r).digest("base64")},t.header=function(e,r,o){var i=o.timestamp||Math.floor((Date.now()+(o.localtimeOffsetMsec||0))/1e3),s=o.credentials;if(!(s&&s.id&&s.key&&s.algorithm))return"";if(-1===["sha1","sha256"].indexOf(s.algorithm))return"";var a,u,c,l,h,p,f={ts:i,nonce:o.nonce||(a=6,u=6*(a+1),n.randomBytes(Math.ceil(u/8)).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"").slice(0,a)),method:r,resource:e.pathname+(e.search||""),host:e.hostname,port:e.port||("http:"===e.protocol?80:443),hash:o.hash,ext:o.ext,app:o.app,dlg:o.dlg};f.hash||!o.payload&&""!==o.payload||(f.hash=(c=o.payload,l=s.algorithm,h=o.contentType,(p=n.createHash(l)).update("hawk.1.payload\n"),p.update((h?h.split(";")[0].trim().toLowerCase():"")+"\n"),p.update(c||""),p.update("\n"),p.digest("base64")));var d=t.calculateMac(s,f),_=null!==f.ext&&void 0!==f.ext&&""!==f.ext,v='Hawk id="'+s.id+'", ts="'+f.ts+'", nonce="'+f.nonce+(f.hash?'", hash="'+f.hash:"")+(_?'", ext="'+f.ext.replace(/\\/g,"\\\\").replace(/"/g,'\\"'):"")+'", mac="'+d+'"';return f.app&&(v=v+', app="'+f.app+(f.dlg?'", dlg="'+f.dlg:"")+'"'),v}},function(e,t,r){"use strict";var n=r(12),o=r(83),i=r(20),s=r(5).Buffer;function a(e){this.request=e,this.boundary=n(),this.chunked=!1,this.body=null}a.prototype.isChunked=function(e){var t=this,r=!1,n=e.data||e;return n.forEach||t.request.emit("error",new Error("Argument error, options.multipart.")),void 0!==e.chunked&&(r=e.chunked),"chunked"===t.request.getHeader("transfer-encoding")&&(r=!0),r||n.forEach((function(e){void 0===e.body&&t.request.emit("error",new Error("Body attribute missing in multipart.")),i(e.body)&&(r=!0)})),r},a.prototype.setHeaders=function(e){e&&!this.request.hasHeader("transfer-encoding")&&this.request.setHeader("transfer-encoding","chunked");var t=this.request.getHeader("content-type");t&&-1!==t.indexOf("multipart")?-1!==t.indexOf("boundary")?this.boundary=t.replace(/.*boundary=([^\s;]+).*/,"$1"):this.request.setHeader("content-type",t+"; boundary="+this.boundary):this.request.setHeader("content-type","multipart/related; boundary="+this.boundary)},a.prototype.build=function(e,t){var r=this,n=t?new o:[];function i(e){return"number"==typeof e&&(e=e.toString()),t?n.append(e):n.push(s.from(e))}return r.request.preambleCRLF&&i("\r\n"),e.forEach((function(e){var t="--"+r.boundary+"\r\n";Object.keys(e).forEach((function(r){"body"!==r&&(t+=r+": "+e[r]+"\r\n")})),i(t+="\r\n"),i(e.body),i("\r\n")})),i("--"+r.boundary+"--"),r.request.postambleCRLF&&i("\r\n"),n},a.prototype.onRequest=function(e){var t=this.isChunked(e),r=e.data||e;this.setHeaders(t),this.chunked=t,this.body=this.build(r,t)},t.Multipart=a},function(e,t){e.exports=require("combined-stream")},function(e,t,r){"use strict";var n=r(6),o=/^https?:/;function i(e){this.request=e,this.followRedirect=!0,this.followRedirects=!0,this.followAllRedirects=!1,this.followOriginalHttpMethod=!1,this.allowRedirect=function(){return!0},this.maxRedirects=10,this.redirects=[],this.redirectsFollowed=0,this.removeRefererHeader=!1}i.prototype.onRequest=function(e){void 0!==e.maxRedirects&&(this.maxRedirects=e.maxRedirects),"function"==typeof e.followRedirect&&(this.allowRedirect=e.followRedirect),void 0!==e.followRedirect&&(this.followRedirects=!!e.followRedirect),void 0!==e.followAllRedirects&&(this.followAllRedirects=e.followAllRedirects),(this.followRedirects||this.followAllRedirects)&&(this.redirects=this.redirects||[]),void 0!==e.removeRefererHeader&&(this.removeRefererHeader=e.removeRefererHeader),void 0!==e.followOriginalHttpMethod&&(this.followOriginalHttpMethod=e.followOriginalHttpMethod)},i.prototype.redirectTo=function(e){var t=this.request,r=null;if(e.statusCode>=300&&e.statusCode<400&&e.caseless.has("location")){var n=e.caseless.get("location");if(t.debug("redirect",n),this.followAllRedirects)r=n;else if(this.followRedirects)switch(t.method){case"PATCH":case"PUT":case"POST":case"DELETE":break;default:r=n}}else if(401===e.statusCode){var o=t._auth.onResponse(e);o&&(t.setHeader("authorization",o),r=t.uri)}return r},i.prototype.onResponse=function(e){var t=this.request,r=this.redirectTo(e);if(!r||!this.allowRedirect.call(t,e))return!1;if(t.debug("redirect to",r),e.resume&&e.resume(),this.redirectsFollowed>=this.maxRedirects)return t.emit("error",new Error("Exceeded maxRedirects. Probably stuck in a redirect loop "+t.uri.href)),!1;this.redirectsFollowed+=1,o.test(r)||(r=n.resolve(t.uri.href,r));var i=t.uri;return t.uri=n.parse(r),t.uri.protocol!==i.protocol&&delete t.agent,this.redirects.push({statusCode:e.statusCode,redirectUri:r}),this.followAllRedirects&&"HEAD"!==t.method&&401!==e.statusCode&&307!==e.statusCode&&(t.method=this.followOriginalHttpMethod?t.method:"GET"),delete t.src,delete t.req,delete t._started,401!==e.statusCode&&307!==e.statusCode&&(delete t.body,delete t._form,t.headers&&(t.removeHeader("host"),t.removeHeader("content-type"),t.removeHeader("content-length"),t.uri.hostname!==t.originalHost.split(":")[0]&&t.removeHeader("authorization"))),this.removeRefererHeader||t.setHeader("referer",i.href),t.emit("redirect"),t.init(),!0},t.Redirect=i},function(e,t,r){"use strict";var n=r(6),o=r(86),i=["accept","accept-charset","accept-encoding","accept-language","accept-ranges","cache-control","content-encoding","content-language","content-location","content-md5","content-range","content-type","connection","date","expect","max-forwards","pragma","referer","te","user-agent","via"],s=["proxy-authorization"];function a(e){this.request=e,this.proxyHeaderWhiteList=i,this.proxyHeaderExclusiveList=[],void 0!==e.tunnel&&(this.tunnelOverride=e.tunnel)}a.prototype.isEnabled=function(){var e=this.request;return void 0!==this.tunnelOverride?this.tunnelOverride:"https:"===e.uri.protocol},a.prototype.setup=function(e){var t=this.request;if(e=e||{},"string"==typeof t.proxy&&(t.proxy=n.parse(t.proxy)),!t.proxy||!t.tunnel)return!1;e.proxyHeaderWhiteList&&(this.proxyHeaderWhiteList=e.proxyHeaderWhiteList),e.proxyHeaderExclusiveList&&(this.proxyHeaderExclusiveList=e.proxyHeaderExclusiveList);var r,i,a,u,c=this.proxyHeaderExclusiveList.concat(s),l=this.proxyHeaderWhiteList.concat(c),h=function(e,t){var r=t.reduce((function(e,t){return e[t.toLowerCase()]=!0,e}),{});return Object.keys(e).filter((function(e){return r[e.toLowerCase()]})).reduce((function(t,r){return t[r]=e[r],t}),{})}(t.headers,l);h.host=(r=t.uri,i=r.port,a=r.protocol,u=r.hostname+":",u+=i||("https:"===a?"443":"80")),c.forEach(t.removeHeader,t);var p=function(e){var t=function(e,t){return["https:"===e.protocol?"https":"http","https:"===t.protocol?"Https":"Http"].join("Over")}(e.uri,e.proxy);return o[t]}(t),f=function(e,t){var r=e.proxy;return{proxy:{host:r.hostname,port:+r.port,proxyAuth:r.auth,headers:t},headers:e.headers,ca:e.ca,cert:e.cert,key:e.key,passphrase:e.passphrase,pfx:e.pfx,ciphers:e.ciphers,rejectUnauthorized:e.rejectUnauthorized,secureOptions:e.secureOptions,secureProtocol:e.secureProtocol}}(t,h);return t.agent=p(f),!0},a.defaultProxyHeaderWhiteList=i,a.defaultProxyHeaderExclusiveList=s,t.Tunnel=a},function(e,t){e.exports=require("tunnel-agent")},function(e,t){e.exports=require("performance-now")},function(e,t){e.exports=require("os")},function(e,t,r){"use strict";e.exports=r(90)},function(e,t){e.exports=require("request-promise-core/errors")},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function s(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a=i(r(3)),u=i(r(4)),c=i(r(22)),l=i(r(23)),h=s(r(13)),p=i(r(7)),f=function(){function e(e){var t=this;this.instances=new Map,e.forEach((function(e){var r=a.default.createHash("md5").update(e).digest("hex");t.instances.set(r,new h.default(e))}))}return e.prototype.addInstance=function(e){var t=a.default.createHash("md5").update(e).digest("hex");if(this.instances.has(t))throw new p.default("Disk instance already exists.");this.instances.set(t,new h.default(e))},e.prototype.removeInstance=function(e){if(!this.instances.has(e))throw new p.default("Disk instance not found.");this.instances.delete(e)},e.prototype.getStatus=function(){return n(this,void 0,void 0,(function(){var e,t=this;return o(this,(function(r){switch(r.label){case 0:return e=Array.from(this.instances.values()).map((function(e){return n(t,void 0,void 0,(function(){var t,r,n;return o(this,(function(o){switch(o.label){case 0:return[4,e.getStatus()];case 1:return t=o.sent(),r=t.totalSpace,n=t.usedSpace,[2,{totalSpace:r,usedSpace:n}]}}))}))})),[4,u.default.all(e)];case 1:return[2,r.sent().reduce((function(e,t){var r=e.totalSpace,n=e.usedSpace;return{totalSpace:r+t.totalSpace,usedSpace:n+t.usedSpace}}))]}}))}))},e.prototype.getDirList=function(e,t){return void 0===t&&(t={offset:0,limit:20,sort:h.SortBy.Created}),n(this,void 0,void 0,(function(){var r,i,s,c,l,f=this;return o(this,(function(d){switch(d.label){case 0:return"/"!==e?[3,2]:(r=Array.from(this.instances.values()).map((function(e){return n(f,void 0,void 0,(function(){var t;return o(this,(function(r){switch(r.label){case 0:return[4,e.getStatus()];case 1:return t=r.sent().usedSpace,[2,{name:a.default.createHash("md5").update(e.token).digest("hex"),type:h.ResourceType.Dir,size:t}]}}))}))})),[4,u.default.all(r)]);case 1:return[2,d.sent()];case 2:if(i=e.slice(1).split("/"),s=i[0],c=i.slice(1),!(l=this.instances.get(s)))throw new p.default("Disk instance not found.");return[4,l.getDirList("/"+c.join("/"),t)];case 3:return[2,d.sent()]}}))}))},e.prototype.getFileLink=function(e){return n(this,void 0,void 0,(function(){var t,r,n,i;return o(this,(function(o){switch(o.label){case 0:if(t=e.slice(1).split("/"),r=t[0],n=t.slice(1),!(i=this.instances.get(r)))throw new Error("Disk instance not found.");return[4,i.getFileLink("/"+n.join("/"))];case 1:return[2,o.sent()]}}))}))},e.prototype.uploadFile=function(e,t){return n(this,void 0,void 0,(function(){var r,i,s,h,f,d,_,v=this;return o(this,(function(y){switch(y.label){case 0:return r=Array.from(this.instances.values()).map((function(e){return n(v,void 0,void 0,(function(){var t,r,n;return o(this,(function(o){switch(o.label){case 0:return[4,e.getStatus()];case 1:return t=o.sent(),r=t.totalSpace,n=t.usedSpace,[2,{id:a.default.createHash("md5").update(e.token).digest("hex"),freeSpace:r-n}]}}))}))})),[4,u.default.all(r)];case 1:return i=y.sent(),s=i.sort((function(e,t){return t.freeSpace-e.freeSpace}))[0],h=s.id,f=s.freeSpace,[4,c.default(e)];case 2:if(d=y.sent(),f<d.length)throw new p.default("Not enough free space.");if(!(_=this.instances.get(h)))throw new p.default("Disk instance not found.");return[4,_.uploadFile(l.default(d),t)];case 3:return[2,y.sent()]}}))}))},e.prototype.removeFile=function(e){return n(this,void 0,void 0,(function(){var t,r,n,i;return o(this,(function(o){switch(o.label){case 0:if(t=e.slice(1).split("/"),r=t[0],n=t.slice(1),!(i=this.instances.get(r)))throw new p.default("Disk instance not found.");return[4,i.removeFile("/"+n.join("/"))];case 1:return[2,o.sent()]}}))}))},e}();t.default=f}])}));